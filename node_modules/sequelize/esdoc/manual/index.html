<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../">
  <title data-ice="title">Manual</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
<link data-ice="userStyle" rel="stylesheet" href="user/css/0-style.css">
</head>
<body class="layout-container manual-root manual-index" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/sequelize/sequelize.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div class="manual-toc-root">
  
<div data-ice="manual" data-toc-name="installation">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1 manual-color manual-color-installation" data-section-count="&#x25A0;&#x25A0;" data-link="manual/installation/getting-started.html"><a href="manual/installation/getting-started.html" data-ice="link">Getting started</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/installation/getting-started.html"><a href="manual/installation/getting-started.html#installation" data-ice="link">Installation</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/installation/getting-started.html"><a href="manual/installation/getting-started.html#setting-up-a-connection" data-ice="link">Setting up a connection</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/installation/getting-started.html"><a href="manual/installation/getting-started.html#test-the-connection" data-ice="link">Test the connection</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/installation/getting-started.html"><a href="manual/installation/getting-started.html#your-first-model" data-ice="link">Your first model</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/installation/getting-started.html"><a href="manual/installation/getting-started.html#your-first-query" data-ice="link">Your first query</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/installation/getting-started.html"><a href="manual/installation/getting-started.html#application-wide-model-options" data-ice="link">Application wide model options</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/installation/getting-started.html"><a href="manual/installation/getting-started.html#promises" data-ice="link">Promises</a></li>
</ul>
  </div>
<div data-ice="manual" data-toc-name="tutorial">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html" data-ice="link">Model definition</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#data-types" data-ice="link">Data types</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#range-types" data-ice="link">Range types</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#special-cases" data-ice="link">Special Cases</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#deferrable" data-ice="link">Deferrable</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#getters-setters" data-ice="link">Getters &amp; setters</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#defining-as-part-of-a-property" data-ice="link">Defining as part of a property</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#defining-as-part-of-the-model-options" data-ice="link">Defining as part of the model options</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#helper-functions-for-use-inside-getter-and-setter-definitions" data-ice="link">Helper functions for use inside getter and setter definitions</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#validations" data-ice="link">Validations</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#validators-and-allownull-" data-ice="link">Validators and allowNull</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#model-validations" data-ice="link">Model validations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#configuration" data-ice="link">Configuration</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#import" data-ice="link">Import</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#optimistic-locking" data-ice="link">Optimistic Locking</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#database-synchronization" data-ice="link">Database synchronization</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#expansion-of-models" data-ice="link">Expansion of models</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-definition.html"><a href="manual/tutorial/models-definition.html#indexes" data-ice="link">Indexes</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html" data-ice="link">Model usage</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#data-retrieval-finders" data-ice="link">Data retrieval / Finders</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#find-search-for-one-specific-element-in-the-database" data-ice="link">find - Search for one specific element in the database</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#findorcreate-search-for-a-specific-element-or-create-it-if-not-available" data-ice="link">findOrCreate - Search for a specific element or create it if not available</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#findandcountall-search-for-multiple-elements-in-the-database-returns-both-data-and-total-count" data-ice="link">findAndCountAll - Search for multiple elements in the database, returns both data and total count</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#findall-search-for-multiple-elements-in-the-database" data-ice="link">findAll - Search for multiple elements in the database</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#complex-filtering-or-not-queries" data-ice="link">Complex filtering / OR / NOT queries</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#manipulating-the-dataset-with-limit-offset-order-and-group" data-ice="link">Manipulating the dataset with limit, offset, order and group</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#raw-queries" data-ice="link">Raw queries</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#count-count-the-occurrences-of-elements-in-the-database" data-ice="link">count - Count the occurrences of elements in the database</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#max-get-the-greatest-value-of-a-specific-attribute-within-a-specific-table" data-ice="link">max - Get the greatest value of a specific attribute within a specific table</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#min-get-the-least-value-of-a-specific-attribute-within-a-specific-table" data-ice="link">min - Get the least value of a specific attribute within a specific table</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#sum-sum-the-value-of-specific-attributes" data-ice="link">sum - Sum the value of specific attributes</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#eager-loading" data-ice="link">Eager loading</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#including-everything" data-ice="link">Including everything</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#including-soft-deleted-records" data-ice="link">Including soft deleted records</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#ordering-eager-loaded-associations" data-ice="link">Ordering Eager Loaded Associations</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/models-usage.html"><a href="manual/tutorial/models-usage.html#nested-eager-loading" data-ice="link">Nested eager loading</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html" data-ice="link">Querying</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#attributes" data-ice="link">Attributes</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#where" data-ice="link">Where</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#basics" data-ice="link">Basics</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#operators" data-ice="link">Operators</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#range-operators" data-ice="link">Range Operators</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#combinations" data-ice="link">Combinations</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#jsonb" data-ice="link">JSONB</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#nested-object" data-ice="link">Nested object</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#nested-key" data-ice="link">Nested key</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#containment" data-ice="link">Containment</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#relations-associations" data-ice="link">Relations / Associations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#pagination-limiting" data-ice="link">Pagination / Limiting</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/querying.html"><a href="manual/tutorial/querying.html#ordering" data-ice="link">Ordering</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html" data-ice="link">Instances</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#building-a-non-persistent-instance" data-ice="link">Building a non-persistent instance</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#creating-persistent-instances" data-ice="link">Creating persistent instances</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#updating-saving-persisting-an-instance" data-ice="link">Updating / Saving / Persisting an instance</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#destroying-deleting-persistent-instances" data-ice="link">Destroying / Deleting persistent instances</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#working-in-bulk-creating-updating-and-destroying-multiple-rows-at-once-" data-ice="link">Working in bulk (creating, updating and destroying multiple rows at once)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#values-of-an-instance" data-ice="link">Values of an instance</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#reloading-instances" data-ice="link">Reloading instances</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#incrementing-certain-values-of-an-instance" data-ice="link">Incrementing certain values of an instance</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/instances.html"><a href="manual/tutorial/instances.html#decrementing-certain-values-of-an-instance" data-ice="link">Decrementing certain values of an instance</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;&#x25A0;" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html" data-ice="link">Associations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#one-to-one-associations" data-ice="link">One-To-One associations</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#belongsto" data-ice="link">BelongsTo</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#foreign-keys" data-ice="link">Foreign keys</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#target-keys" data-ice="link">Target keys</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#hasone" data-ice="link">HasOne</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#difference-between-hasone-and-belongsto" data-ice="link">Difference between HasOne and BelongsTo</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#one-to-many-associations" data-ice="link">One-To-Many associations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#belongs-to-many-associations" data-ice="link">Belongs-To-Many associations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#scopes" data-ice="link">Scopes</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#1-m" data-ice="link">1:m</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#n-m" data-ice="link">n:m</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#naming-strategy" data-ice="link">Naming strategy</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#associating-objects" data-ice="link">Associating objects</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#check-associations" data-ice="link">Check associations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#foreign-keys" data-ice="link">Foreign Keys</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#enforcing-a-foreign-key-reference-without-constraints" data-ice="link">Enforcing a foreign key reference without constraints</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#creating-with-associations" data-ice="link">Creating with associations</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#creating-elements-of-a-belongsto-has-many-or-hasone-association" data-ice="link">Creating elements of a &quot;BelongsTo&quot;, &quot;Has Many&quot; or &quot;HasOne&quot; association</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#creating-elements-of-a-belongsto-association-with-an-alias" data-ice="link">Creating elements of a &quot;BelongsTo&quot; association with an alias</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/associations.html"><a href="manual/tutorial/associations.html#creating-elements-of-a-hasmany-or-belongstomany-association" data-ice="link">Creating elements of a &quot;HasMany&quot; or &quot;BelongsToMany&quot; association</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html" data-ice="link">Transactions</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#managed-transaction-auto-callback-" data-ice="link">Managed transaction (auto-callback)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#throw-errors-to-rollback" data-ice="link">Throw errors to rollback</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#automatically-pass-transactions-to-all-queries" data-ice="link">Automatically pass transactions to all queries</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#concurrent-partial-transactions" data-ice="link">Concurrent/Partial transactions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#without-cls-enabled" data-ice="link">Without CLS enabled</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#isolation-levels" data-ice="link">Isolation levels</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#unmanaged-transaction-then-callback-" data-ice="link">Unmanaged transaction (then-callback)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#options" data-ice="link">Options</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/transactions.html"><a href="manual/tutorial/transactions.html#usage-with-other-sequelize-methods" data-ice="link">Usage with other sequelize methods</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;" data-link="manual/tutorial/scopes.html"><a href="manual/tutorial/scopes.html" data-ice="link">Scopes</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/scopes.html"><a href="manual/tutorial/scopes.html#definition" data-ice="link">Definition</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/scopes.html"><a href="manual/tutorial/scopes.html#usage" data-ice="link">Usage</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/scopes.html"><a href="manual/tutorial/scopes.html#merging" data-ice="link">Merging</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/scopes.html"><a href="manual/tutorial/scopes.html#associations" data-ice="link">Associations</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html" data-ice="link">Hooks</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#order-of-operations" data-ice="link">Order of Operations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#declaring-hooks" data-ice="link">Declaring Hooks</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#removing-hooks" data-ice="link">Removing hooks</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#global-universal-hooks" data-ice="link">Global / universal hooks</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#sequelize-options-define-default-hook-" data-ice="link">Sequelize.options.define (default hook)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#sequelize-addhook-permanent-hook-" data-ice="link">Sequelize.addHook (permanent hook)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#instance-hooks" data-ice="link">Instance hooks</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#model-hooks" data-ice="link">Model hooks</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#associations" data-ice="link">Associations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#a-note-about-transactions" data-ice="link">A Note About Transactions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/hooks.html"><a href="manual/tutorial/hooks.html#internal-transactions" data-ice="link">Internal Transactions</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;" data-link="manual/tutorial/raw-queries.html"><a href="manual/tutorial/raw-queries.html" data-ice="link">Raw queries</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/raw-queries.html"><a href="manual/tutorial/raw-queries.html#replacements" data-ice="link">Replacements</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/raw-queries.html"><a href="manual/tutorial/raw-queries.html#bind-parameter" data-ice="link">Bind Parameter</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html" data-ice="link">Migrations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#the-cli" data-ice="link">The CLI</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#skeleton" data-ice="link">Skeleton</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#functions" data-ice="link">Functions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#createtable-tablename-attributes-options-" data-ice="link">createTable(tableName, attributes, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#droptable-tablename-options-" data-ice="link">dropTable(tableName, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#dropalltables-options-" data-ice="link">dropAllTables(options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#renametable-before-after-options-" data-ice="link">renameTable(before, after, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#showalltables-options-" data-ice="link">showAllTables(options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#describetable-tablename-options-" data-ice="link">describeTable(tableName, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#addcolumn-tablenameoroptions-attributename-datatypeoroptions-options-" data-ice="link">addColumn(tableNameOrOptions, attributeName, dataTypeOrOptions, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#removecolumn-tablenameoroptions-attributename-options-" data-ice="link">removeColumn(tableNameOrOptions, attributeName, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#changecolumn-tablename-attributename-datatypeoroptions-options-" data-ice="link">changeColumn(tableName, attributeName, dataTypeOrOptions, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#renamecolumn-tablename-attrnamebefore-attrnameafter-options-" data-ice="link">renameColumn(tableName, attrNameBefore, attrNameAfter, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#addindex-tablename-attributes-options-" data-ice="link">addIndex(tableName, attributes, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#removeindex-tablename-indexnameorattributes-options-" data-ice="link">removeIndex(tableName, indexNameOrAttributes, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial/migrations.html"><a href="manual/tutorial/migrations.html#programmatic-use" data-ice="link">Programmatic use</a></li>
</ul>
  </div>
<div data-ice="manual" data-toc-name="advanced">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1 manual-color manual-color-advanced" data-section-count="&#x25A0;&#x25A0;" data-link="manual/advanced/legacy.html"><a href="manual/advanced/legacy.html" data-ice="link">Working with legacy tables</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/advanced/legacy.html"><a href="manual/advanced/legacy.html#tables" data-ice="link">Tables</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/advanced/legacy.html"><a href="manual/advanced/legacy.html#fields" data-ice="link">Fields</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/advanced/legacy.html"><a href="manual/advanced/legacy.html#primary-keys" data-ice="link">Primary keys</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/advanced/legacy.html"><a href="manual/advanced/legacy.html#foreign-keys" data-ice="link">Foreign keys</a></li>
</ul>
  </div>
<div data-ice="manual" data-toc-name="reference">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1 manual-color manual-color-reference" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;&#x25A0;" data-link="identifiers.html"><a href="identifiers.html" data-ice="link">Reference</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="identifiers.html"><a href="identifiers.html#class" data-ice="link">Class</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="identifiers.html"><a href="identifiers.html#variable" data-ice="link">Variable</a></li>
</ul>
  </div>
<div data-ice="manual" data-toc-name="faq">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1 manual-color manual-color-faq" data-section-count="&#x25A0;" data-link="manual/faq/whos-using.html"><a href="manual/faq/whos-using.html" data-ice="link">Who&apos;s using sequelize?</a></li>
<li data-ice="manualNav" class="indent-h1 manual-color manual-color-faq" data-section-count="&#x25A0;" data-link="manual/faq/imprint.html"><a href="manual/faq/imprint.html" data-ice="link">Imprint</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/faq/imprint.html"><a href="manual/faq/imprint.html#author-s-" data-ice="link">AUTHOR(S)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/faq/imprint.html"><a href="manual/faq/imprint.html#inhaltliche-verantwortung" data-ice="link">INHALTLICHE VERANTWORTUNG</a></li>
</ul>
  </div>
</div>
</nav>

<div class="content" data-ice="content"><div class="github-markdown">
  <div class="manual-user-index" data-ice="manualUserIndex"><p><img src="manual/asset/logo-small.png" alt="logo"></p>
<p>Sequelize is a promise-based ORM for Node.js. It supports the dialects PostgreSQL, MySQL, SQLite and MSSQL and features solid transaction support, relations, read replication and
more.</p>
<p><a href="docs/getting-started/">Installation</a></p>
<h2 id="example-usage">Example usage</h2>
<pre><code class="lang-js"><code class="source-code prettyprint">var Sequelize = require(&apos;sequelize&apos;);
var sequelize = new Sequelize(&apos;database&apos;, &apos;username&apos;, &apos;password&apos;);

var User = sequelize.define(&apos;user&apos;, {
  username: Sequelize.STRING,
  birthday: Sequelize.DATE
});

sequelize.sync().then(function() {
  return User.create({
    username: &apos;janedoe&apos;,
    birthday: new Date(1980, 6, 20)
  });
}).then(function(jane) {
  console.log(jane.get({
    plain: true
  }));
});</code>
</code></pre>
</div>

  <p class="manual-badge" data-ice="manualBadge"><img src="./manual-badge.svg"></p>

  <div class="manual-cards">
    
  <div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-installation" data-section-count="&#x25A0;&#x25A0;"><span data-ice="label-inner">Getting started</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Getting started</h1><h2>Installation</h2><p>Sequelize is available via NPM.</p><pre><code class="lang-bash"><code class="source-code prettyprint">$ npm install --save sequelize

# And one of the following:
$ npm install --save pg pg-hstore
$ npm install --save mysql2
$ npm install --save sqlite3
$ npm install --save tedious // MSSQL</code>
</code></pre><h2>Setting up a connection</h2><p>Sequelize will setup a connection pool on initialization so you should ideally only ever create one instance per database if you&apos;re connecting to the DB from a single process. If you&apos;re connecting to the DB from multiple processes, you&apos;ll have to create one instance per process, but each instance should have a maximum connection pool size of &quot;max connection pool size divided by number of instances&quot;.  So, if you wanted a max connection pool size of 90 and you had 3 worker processes, each process&apos;s instance should have a max connection pool size of 30.</p><pre><code class="lang-js"><code class="source-code prettyprint">var sequelize = new Sequelize(&apos;database&apos;, &apos;username&apos;, &apos;password&apos;, {
  host: &apos;localhost&apos;,
  dialect: &apos;mysql&apos;|&apos;sqlite&apos;|&apos;postgres&apos;|&apos;mssql&apos;,

  pool: {
    max: 5,
    min: 0,
    idle: 10000
  },

  // SQLite only
  storage: &apos;path/to/database.sqlite&apos;
});

// Or you can simply use a connection uri
var sequelize = new Sequelize(&apos;postgres://user:pass@example.com:5432/dbname&apos;);</code>
</code></pre><p>The Sequelize constructor takes a whole slew of options that are available via the <a href="http://sequelize.readthedocs.org/en/latest/api/sequelize/">API reference</a>.</p><h2>Test the connection</h2><p>You can use the <code>.authenticate()</code> function like this to test the connection.</p><pre><code><code class="source-code prettyprint">sequelize
  .authenticate()
  .then(function(err) {
    console.log(&apos;Connection has been established successfully.&apos;);
  })
  .catch(function (err) {
    console.log(&apos;Unable to connect to the database:&apos;, err);
  });</code>
</code></pre><h2>Your first model</h2><p>Models are defined with <code>sequelize.define(&apos;name&apos;, {attributes}, {options})</code>.</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = sequelize.define(&apos;user&apos;, {
  firstName: {
    type: Sequelize.STRING
  },
  lastName: {
    type: Sequelize.STRING
  }
});

// force: true will drop the table if it already exists
User.sync({force: true}).then(function () {
  // Table created
  return User.create({
    firstName: &apos;John&apos;,
    lastName: &apos;Hancock&apos;
  });
});</code>
</code></pre><p>You can read more about creating models at <a href="http://sequelize.readthedocs.org/en/latest/api/model/">Model API reference</a></p><h2>Your first query</h2><pre><code><code class="source-code prettyprint">User.findAll().then(function(users) {
  console.log(users)
})</code>
</code></pre><p>You can read more about finder functions on models like <code>.findAll()</code> at <a href="http://docs.sequelizejs.com/en/latest/docs/models-usage/">Data retrieval</a> or how to do specific queries like <code>WHERE</code> and <code>JSONB</code> at <a href="http://docs.sequelizejs.com/en/latest/docs/querying/">Querying</a>.</p><h3>Application wide model options</h3><p>The Sequelize constructor takes a <code>define</code> option which will be used as the default options for all defined models.</p><pre><code class="lang-js"><code class="source-code prettyprint">var sequelize = new Sequelize(&apos;connectionUri&apos;, {
  define: {
    timestamps: false // true by default
  }
});

var User = sequelize.define(&apos;user&apos;, {}); // timestamps is false by default
var Post = sequelize.define(&apos;post&apos;, {}, {
  timestamps: true // timestamps will now be true
});</code>
</code></pre><h2>Promises</h2><p>Sequelize uses promises to control async control-flow. If you are unfamiliar with how promises work, don&apos;t worry, you can read up on them <a href="https://github.com/wbinnssmith/awesome-promises">here</a> and <a href="http://bluebirdjs.com/docs/why-promises.html">here</a>.</p><p>Basically, a promise represents a value which will be present at some point - &quot;I promise you I will give you a result or an error at some point&quot;. This means that</p><pre><code class="lang-js"><code class="source-code prettyprint">// DON&apos;T DO THIS
user = User.findOne()

console.log(user.get(&apos;firstName&apos;));</code>
</code></pre><p><em>will never work!</em> This is because <code>user</code> is a promise object, not a data row from the DB. The right way to do it is:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findOne().then(function (user) {
    console.log(user.get(&apos;firstName&apos;));
});</code>
</code></pre><p>Once you&apos;ve got the hang of what promises are and how they work, use the <a href="http://bluebirdjs.com/docs/api-reference.html">bluebird API reference</a> as your go-to tool. In particular, you&apos;ll probably be using <a href="http://bluebirdjs.com/docs/api/promise.all.html"><code>.all</code></a> a lot.  </p></div>
        <a data-ice="link" href="manual/installation/getting-started.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">Model definition</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Model definition</h1><p>To define mappings between a model and a table, use the <code>define</code> method. Sequelize will then automatically add the attributes <code>createdAt</code> and <code>updatedAt</code> to it. So you will be able to know when the database entry went into the db and when it was updated the last time. If you do not want timestamps on your models, only want some timestamps, or you are working with an existing database where the columns are named something else, jump straight on to <a href="#configuration">configuration </a>to see how to do that.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Project = sequelize.define(&apos;project&apos;, {
  title: Sequelize.STRING,
  description: Sequelize.TEXT
})

var Task = sequelize.define(&apos;task&apos;, {
  title: Sequelize.STRING,
  description: Sequelize.TEXT,
  deadline: Sequelize.DATE
})</code>
</code></pre><p>You can also set some options on each column:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Foo = sequelize.define(&apos;foo&apos;, {
 // instantiating will automatically set the flag to true if not set
 flag: { type: Sequelize.BOOLEAN, allowNull: false, defaultValue: true},

 // default values for dates =&gt; current time
 myDate: { type: Sequelize.DATE, defaultValue: Sequelize.NOW },

 // setting allowNull to false will add NOT NULL to the column, which means an error will be
 // thrown from the DB when the query is executed if the column is null. If you want to check that a value
 // is not null before querying the DB, look at the validations section below.
 title: { type: Sequelize.STRING, allowNull: false},

 // Creating two objects with the same value will throw an error. The unique property can be either a
 // boolean, or a string. If you provide the same string for multiple columns, they will form a
 // composite unique key.
 uniqueOne: { type: Sequelize.STRING,  unique: &apos;compositeIndex&apos;},
 uniqueTwo: { type: Sequelize.INTEGER, unique: &apos;compositeIndex&apos;}

 // The unique property is simply a shorthand to create a unique constraint.
 someUnique: {type: Sequelize.STRING, unique: true}
 // It&apos;s exactly the same as creating the index in the model&apos;s options.
 {someUnique: {type: Sequelize.STRING}},
 {indexes: [{unique: true, fields: [&apos;someUnique&apos;]}]}

 // Go on reading for further information about primary keys
 identifier: { type: Sequelize.STRING, primaryKey: true},

 // autoIncrement can be used to create auto_incrementing integer columns
 incrementMe: { type: Sequelize.INTEGER, autoIncrement: true },

 // Comments can be specified for each field for MySQL and PG
 hasComment: { type: Sequelize.INTEGER, comment: &quot;I&apos;m a comment!&quot; },

 // You can specify a custom field name via the &quot;field&quot; attribute:
 fieldWithUnderscores: { type: Sequelize.STRING, field: &quot;field_with_underscores&quot; },

 // It is possible to create foreign keys:
 bar_id: {
   type: Sequelize.INTEGER,

   references: {
     // This is a reference to another model
     model: Bar,

     // This is the column name of the referenced model
     key: &apos;id&apos;,

     // This declares when to check the foreign key constraint. PostgreSQL only.
     deferrable: Sequelize.Deferrable.INITIALLY_IMMEDIATE
   }
 }
})</code>
</code></pre><p>The comment option can also be used on a table, see <a href="#configuration">model configuration</a></p><h2>Data types</h2><p>Below are some of the datatypes supported by sequelize. For a full and updated list, see <a href="./manual/../api/datatypes">DataTypes</a>.</p><pre><code class="lang-js"><code class="source-code prettyprint">Sequelize.STRING                      // VARCHAR(255)
Sequelize.STRING(1234)                // VARCHAR(1234)
Sequelize.STRING.BINARY               // VARCHAR BINARY
Sequelize.TEXT                        // TEXT
Sequelize.TEXT(&apos;tiny&apos;)                // TINYTEXT

Sequelize.INTEGER                     // INTEGER
Sequelize.BIGINT                      // BIGINT
Sequelize.BIGINT(11)                  // BIGINT(11)

Sequelize.FLOAT                       // FLOAT
Sequelize.FLOAT(11)                   // FLOAT(11)
Sequelize.FLOAT(11, 12)               // FLOAT(11,12)

Sequelize.REAL                        // REAL        PostgreSQL only.
Sequelize.REAL(11)                    // REAL(11)    PostgreSQL only.
Sequelize.REAL(11, 12)                // REAL(11,12) PostgreSQL only.

Sequelize.DOUBLE                      // DOUBLE
Sequelize.DOUBLE(11)                  // DOUBLE(11)
Sequelize.DOUBLE(11, 12)              // DOUBLE(11,12)

Sequelize.DECIMAL                     // DECIMAL
Sequelize.DECIMAL(10, 2)              // DECIMAL(10,2)

Sequelize.DATE                        // DATETIME for mysql / sqlite, TIMESTAMP WITH TIME ZONE for postgres
Sequelize.DATE(6)                     // DATETIME(6) for mysql 5.6.4+. Fractional seconds support with up to 6 digits of precision
Sequelize.DATEONLY                    // DATE without time.
Sequelize.BOOLEAN                     // TINYINT(1)

Sequelize.ENUM(&apos;value 1&apos;, &apos;value 2&apos;)  // An ENUM with allowed values &apos;value 1&apos; and &apos;value 2&apos;
Sequelize.ARRAY(Sequelize.TEXT)       // Defines an array. PostgreSQL only.

Sequelize.JSON                        // JSON column. PostgreSQL only.
Sequelize.JSONB                       // JSONB column. PostgreSQL only.

Sequelize.BLOB                        // BLOB (bytea for PostgreSQL)
Sequelize.BLOB(&apos;tiny&apos;)                // TINYBLOB (bytea for PostgreSQL. Other options are medium and long)

Sequelize.UUID                        // UUID datatype for PostgreSQL and SQLite, CHAR(36) BINARY for MySQL (use defaultValue: Sequelize.UUIDV1 or Sequelize.UUIDV4 to make sequelize generate the ids automatically)

Sequelize.RANGE(Sequelize.INTEGER)    // Defines int4range range. PostgreSQL only.
Sequelize.RANGE(Sequelize.BIGINT)     // Defined int8range range. PostgreSQL only.
Sequelize.RANGE(Sequelize.DATE)       // Defines tstzrange range. PostgreSQL only.
Sequelize.RANGE(Sequelize.DATEONLY)   // Defines daterange range. PostgreSQL only.
Sequelize.RANGE(Sequelize.DECIMAL)    // Defines numrange range. PostgreSQL only.

Sequelize.ARRAY(Sequelize.RANGE(Sequelize.DATE)) // Defines array of tstzrange ranges. PostgreSQL only.

Sequelize.GEOMETRY                    // Spatial column.  PostgreSQL (with PostGIS) or MySQL only.
Sequelize.GEOMETRY(&apos;POINT&apos;)           // Spatial column with geometry type. PostgreSQL (with PostGIS) or MySQL only.
Sequelize.GEOMETRY(&apos;POINT&apos;, 4326)     // Spatial column with geometry type and SRID.  PostgreSQL (with PostGIS) or MySQL only.</code>
</code></pre><p>The BLOB data type allows you to insert data both as strings and as buffers. When you do a find or findAll on a model which has a BLOB column. that data will always be returned as a buffer.</p><p>If you are working with the PostgreSQL TIMESTAMP WITHOUT TIME ZONE and you need to parse it to a different timezone, please use the pg library&apos;s own parser:</p><pre><code class="lang-js"><code class="source-code prettyprint">require(&apos;pg&apos;).types.setTypeParser(1114, function(stringValue) {
  return new Date(stringValue + &quot;+0000&quot;);
  // e.g., UTC offset. Use any offset that you would like.
});</code>
</code></pre><p>In addition to the type mentioned above, integer, bigint, float and double also support unsigned and zerofill properties, which can be combined in any order:
Be aware that this does not apply for PostgreSQL!</p><pre><code class="lang-js"><code class="source-code prettyprint">Sequelize.INTEGER.UNSIGNED              // INTEGER UNSIGNED
Sequelize.INTEGER(11).UNSIGNED          // INTEGER(11) UNSIGNED
Sequelize.INTEGER(11).ZEROFILL          // INTEGER(11) ZEROFILL
Sequelize.INTEGER(11).ZEROFILL.UNSIGNED // INTEGER(11) UNSIGNED ZEROFILL
Sequelize.INTEGER(11).UNSIGNED.ZEROFILL // INTEGER(11) UNSIGNED ZEROFILL</code>
</code></pre><p><em>The examples above only show integer, but the same can be done with bigint and float</em></p><p>Usage in object notation:</p><pre><code class="lang-js"><code class="source-code prettyprint">// for enums:
sequelize.define(&apos;model&apos;, {
  states: {
    type:   Sequelize.ENUM,
    values: [&apos;active&apos;, &apos;pending&apos;, &apos;deleted&apos;]
  }
})</code>
</code></pre><h3>Range types</h3><p>Since range types have extra information for their bound inclusion/exclusion it&apos;s not
very straightforward to just use a tuple to represent them in javascript.</p><p>When supplying ranges as values you can choose from the following APIs:</p><pre><code class="lang-js"><code class="source-code prettyprint">// defaults to &apos;[&quot;2016-01-01 00:00:00+00:00&quot;, &quot;2016-02-01 00:00:00+00:00&quot;)&apos;
// inclusive lower bound, exclusive upper bound
Timeline.create({ range: [new Date(Date.UTC(2016, 0, 1)), new Date(Date.UTC(2016, 1, 1))] });

// control inclusion
const range = [new Date(Date.UTC(2016, 0, 1)), new Date(Date.UTC(2016, 1, 1))];
range.inclusive = false; // &apos;()&apos;
range.inclusive = [false, true]; // &apos;(]&apos;
range.inclusive = true; // &apos;[]&apos;
range.inclusive = [true, false]; // &apos;[)&apos;

// or as a single expression
const range = [
  { value: new Date(Date.UTC(2016, 0, 1)), inclusive: false },
  { value: new Date(Date.UTC(2016, 1, 1)), inclusive: true },
];
// &apos;(&quot;2016-01-01 00:00:00+00:00&quot;, &quot;2016-02-01 00:00:00+00:00&quot;]&apos;

// composite form
const range = [
  { value: new Date(Date.UTC(2016, 0, 1)), inclusive: false },
  new Date(Date.UTC(2016, 1, 1)),
];
// &apos;(&quot;2016-01-01 00:00:00+00:00&quot;, &quot;2016-02-01 00:00:00+00:00&quot;)&apos;

Timeline.create({ range });</code>
</code></pre><p>However, please note that whenever you get back a value that is range you will
receive:</p><pre><code class="lang-js"><code class="source-code prettyprint">// stored value: (&quot;2016-01-01 00:00:00+00:00&quot;, &quot;2016-02-01 00:00:00+00:00&quot;]
range // [Date, Date]
range.inclusive // [false, true]</code>
</code></pre><p>Make sure you turn that into a serializable format before serialization since array
extra properties will not be serialized.</p><h4>Special Cases</h4><pre><code class="lang-js"><code class="source-code prettyprint">// empty range:
Timeline.create({ range: [] }); // range = &apos;empty&apos;

// Unbounded range:
Timeline.create({ range: [null, null] }); // range = &apos;[,)&apos;
// range = &apos;[,&quot;2016-01-01 00:00:00+00:00&quot;)&apos;
Timeline.create({ range: [null, new Date(Date.UTC(2016, 0, 1))] });

// Infinite range:
// range = &apos;[-infinity,&quot;2016-01-01 00:00:00+00:00&quot;)&apos;
Timeline.create({ range: [-Infinity, new Date(Date.UTC(2016, 0, 1))] });</code>
</code></pre><h2>Deferrable</h2><p>When you specify a foreign key column it is optionally possible to declare the deferrable
type in PostgreSQL. The following options are available:</p><pre><code class="lang-js"><code class="source-code prettyprint">// Defer all foreign key constraint check to the end of a transaction
Sequelize.Deferrable.INITIALLY_DEFERRED

// Immediately check the foreign key constraints
Sequelize.Deferrable.INITIALLY_IMMEDIATE

// Don&apos;t defer the checks at all
Sequelize.Deferrable.NOT</code>
</code></pre><p>The last option is the default in PostgreSQL and won&apos;t allow you to dynamically change
the rule in a transaction. See <a href="./manual/transactions/#options">the transaction section</a> for further information.</p><h2>Getters &amp; setters</h2><p>It is possible to define &apos;object-property&apos; getters and setter functions on your models, these can be used both for &apos;protecting&apos; properties that map to database fields and for defining &apos;pseudo&apos; properties.</p><p>Getters and Setters can be defined in 2 ways (you can mix and match these 2 approaches):</p><ul>
<li>as part of a single property definition</li>
<li>as part of a model options</li>
</ul><p><strong>N.B:</strong> If a getter or setter is defined in both places then the function found in the relevant property definition will always take precedence.</p><h3>Defining as part of a property</h3><pre><code class="lang-js"><code class="source-code prettyprint">var Employee = sequelize.define(&apos;employee&apos;, {
  name:  {
    type     : Sequelize.STRING,
    allowNull: false,
    get      : function()  {
      var title = this.getDataValue(&apos;title&apos;);
      // &apos;this&apos; allows you to access attributes of the instance
      return this.getDataValue(&apos;name&apos;) + &apos; (&apos; + title + &apos;)&apos;;
    },
  },
  title: {
    type     : Sequelize.STRING,
    allowNull: false,
    set      : function(val) {
      this.setDataValue(&apos;title&apos;, val.toUpperCase());
    }
  }
});

Employee
  .create({ name: &apos;John Doe&apos;, title: &apos;senior engineer&apos; })
  .then(function(employee) {
    console.log(employee.get(&apos;name&apos;)); // John Doe (SENIOR ENGINEER)
    console.log(employee.get(&apos;title&apos;)); // SENIOR ENGINEER
  })</code>
</code></pre><h3>Defining as part of the model options</h3><p>Below is an example of defining the getters and setters in the model options. The <code>fullName</code> getter,  is an example of how you can define pseudo properties on your models - attributes which are not actually part of your database schema. In fact, pseudo properties can be defined in two ways: using model getters, or by using a column with the <a href="./manual/../api/datatypes#virtual"><code>VIRTUAL</code> datatype</a>. Virtual datatypes can have validations, while getters for virtual attributes cannot.</p><p>Note that the <code>this.firstname</code> and <code>this.lastname</code> references in the <code>fullName</code> getter function will trigger a call to the respective getter functions. If you do not want that then use the <code>getDataValue()</code> method to access the raw value (see below).</p><pre><code class="lang-js"><code class="source-code prettyprint">var Foo = sequelize.define(&apos;foo&apos;, {
  firstname: Sequelize.STRING,
  lastname: Sequelize.STRING
}, {
  getterMethods   : {
    fullName       : function()  { return this.firstname + &apos; &apos; + this.lastname }
  },

  setterMethods   : {
    fullName       : function(value) {
        var names = value.split(&apos; &apos;);

        this.setDataValue(&apos;firstname&apos;, names.slice(0, -1).join(&apos; &apos;));
        this.setDataValue(&apos;lastname&apos;, names.slice(-1).join(&apos; &apos;));
    },
  }
});</code>
</code></pre><h3>Helper functions for use inside getter and setter definitions</h3><ul>
<li>retrieving an underlying property value - always use <code>this.getDataValue()</code></li>
</ul><pre><code class="lang-js"><code class="source-code prettyprint">/* a getter for &apos;title&apos; property */
function() {
    return this.getDataValue(&apos;title&apos;);
}</code>
</code></pre><ul>
<li>setting an underlying property value - always use <code>this.setDataValue()</code></li>
</ul><pre><code class="lang-js"><code class="source-code prettyprint">/* a setter for &apos;title&apos; property */
function(title) {
    return this.setDataValue(&apos;title&apos;, title.toString().toLowerCase());
}</code>
</code></pre><p><strong>N.B:</strong> It is important to stick to using the <code>setDataValue()</code> and <code>getDataValue()</code> functions (as opposed to accessing the underlying &quot;data values&quot; property directly) - doing so protects your custom getters and setters from changes in the underlying model implementations.</p><h2>Validations</h2><p>Model validations, allow you to specify format/content/inheritance validations for each attribute of the model.</p><p>Validations are automatically run on <code>create</code>, <code>update</code> and <code>save</code>. You can also call <code>validate()</code> to manually validate an instance.</p><p>The validations are implemented by <a href="https://github.com/chriso/validator.js">validator.js</a>.</p><pre><code class="lang-js"><code class="source-code prettyprint">var ValidateMe = sequelize.define(&apos;foo&apos;, {
  foo: {
    type: Sequelize.STRING,
    validate: {
      is: [&quot;^[a-z]+$&quot;,&apos;i&apos;],     // will only allow letters
      is: /^[a-z]+$/i,          // same as the previous example using real RegExp
      not: [&quot;[a-z]&quot;,&apos;i&apos;],       // will not allow letters
      isEmail: true,            // checks for poem format (foo@bar.com)
      isUrl: true,              // checks for url format (http://foo.com)
      isIP: true,               // checks for IPv4 (129.89.23.1) or IPv6 format
      isIPv4: true,             // checks for IPv4 (129.89.23.1)
      isIPv6: true,             // checks for IPv6 format
      isAlpha: true,            // will only allow letters
      isAlphanumeric: true,     // will only allow alphanumeric characters, so &quot;_abc&quot; will fail
      isNumeric: true,          // will only allow numbers
      isInt: true,              // checks for valid integers
      isFloat: true,            // checks for valid floating point numbers
      isDecimal: true,          // checks for any numbers
      isLowercase: true,        // checks for lowercase
      isUppercase: true,        // checks for uppercase
      notNull: true,            // won&apos;t allow null
      isNull: true,             // only allows null
      notEmpty: true,           // don&apos;t allow empty strings
      equals: &apos;specific value&apos;, // only allow a specific value
      contains: &apos;foo&apos;,          // force specific substrings
      notIn: [[&apos;foo&apos;, &apos;bar&apos;]],  // check the value is not one of these
      isIn: [[&apos;foo&apos;, &apos;bar&apos;]],   // check the value is one of these
      notContains: &apos;bar&apos;,       // don&apos;t allow specific substrings
      len: [2,10],              // only allow values with length between 2 and 10
      isUUID: 4,                // only allow uuids
      isDate: true,             // only allow date strings
      isAfter: &quot;2011-11-05&quot;,    // only allow date strings after a specific date
      isBefore: &quot;2011-11-05&quot;,   // only allow date strings before a specific date
      max: 23,                  // only allow values
      min: 23,                  // only allow values &gt;= 23
      isCreditCard: true,       // check for valid credit card numbers

      // custom validations are also possible:
      isEven: function(value) {
        if(parseInt(value) % 2 != 0) {
          throw new Error(&apos;Only even values are allowed!&apos;)
        // we also are in the model&apos;s context here, so this.otherField
        // would get the value of otherField if it existed
        }
      }
    }
  }
});</code>
</code></pre><p>Note that where multiple arguments need to be passed to the built-in validation functions, the arguments to be passed must be in an array. But if a single array argument is to be passed, for instance an array of acceptable strings for <code>isIn</code>, this will be interpreted as multiple string arguments instead of one array argument. To work around this pass a single-length array of arguments, such as <code>[[&apos;one&apos;, &apos;two&apos;]]</code> as shown above.</p><p>To use a custom error message instead of that provided by validator.js, use an object instead of the plain value or array of arguments, for example a validator which needs no argument can be given a custom message with</p><pre><code class="lang-js"><code class="source-code prettyprint">isInt: {
  msg: &quot;Must be an integer number of pennies&quot;
}</code>
</code></pre><p>or if arguments need to also be passed add an<code>args</code>property:</p><pre><code class="lang-js"><code class="source-code prettyprint">isIn: {
  args: [[&apos;en&apos;, &apos;zh&apos;]],
  msg: &quot;Must be English or Chinese&quot;
}</code>
</code></pre><p>When using custom validator functions the error message will be whatever message the thrown<code>Error</code>object holds.</p><p>See <a href="https://github.com/chriso/validator.js">the validator.js project</a> for more details on the built in validation methods.</p><p><strong>Hint: </strong>You can also define a custom function for the logging part. Just pass a function. The first parameter will be the string that is logged.</p><h3>Validators and <code>allowNull</code></h3><p>If a particular field of a model is set to allow null (with <code>allowNull: true</code>) and that value has been set to <code>null</code> , its validators do not run. This means you can, for instance, have a string field which validates its length to be at least 5 characters, but which also allows<code>null</code>.</p><h3>Model validations</h3><p>Validations can also be defined to check the model after the field-specific validators. Using this you could, for example, ensure either neither of <code>latitude</code> and <code>longitude</code> are set or both, and fail if one but not the other is set.</p><p>Model validator methods are called with the model object&apos;s context and are deemed to fail if they throw an error, otherwise pass. This is just the same as with custom field-specific validators.</p><p>Any error messages collected are put in the validation result object alongside the field validation errors, with keys named after the failed validation method&apos;s key in the <code>validate</code> option object. Even though there can only be one error message for each model validation method at any one time, it is presented as a single string error in an array, to maximize consistency with the field errors.</p><p>An example:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Pub = Sequelize.define(&apos;pub&apos;, {
  name: { type: Sequelize.STRING },
  address: { type: Sequelize.STRING },
  latitude: {
    type: Sequelize.INTEGER,
    allowNull: true,
    defaultValue: null,
    validate: { min: -90, max: 90 }
  },
  longitude: {
    type: Sequelize.INTEGER,
    allowNull: true,
    defaultValue: null,
    validate: { min: -180, max: 180 }
  },
}, {
  validate: {
    bothCoordsOrNone: function() {
      if ((this.latitude === null) !== (this.longitude === null)) {
        throw new Error(&apos;Require either both latitude and longitude or neither&apos;)
      }
    }
  }
})</code>
</code></pre><p>In this simple case an object fails validation if either latitude or longitude is given, but not both. If we try to build one with an out-of-range latitude and no longitude, <code>raging_bullock_arms.validate()</code> might return</p><pre><code class="lang-js"><code class="source-code prettyprint">{
  &apos;latitude&apos;: [&apos;Invalid number: latitude&apos;],
  &apos;bothCoordsOrNone&apos;: [&apos;Require either both latitude and longitude or neither&apos;]
}</code>
</code></pre><h2>Configuration</h2><p>You can also influence the way Sequelize handles your column names:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Bar = sequelize.define(&apos;bar&apos;, { /* bla */ }, {
  // don&apos;t add the timestamp attributes (updatedAt, createdAt)
  timestamps: false,

  // don&apos;t delete database entries but set the newly added attribute deletedAt
  // to the current date (when deletion was done). paranoid will only work if
  // timestamps are enabled
  paranoid: true,

  // don&apos;t use camelcase for automatically added attributes but underscore style
  // so updatedAt will be updated_at
  underscored: true,

  // disable the modification of table names; By default, sequelize will automatically
  // transform all passed model names (first parameter of define) into plural.
  // if you don&apos;t want that, set the following
  freezeTableName: true,

  // define the table&apos;s name
  tableName: &apos;my_very_custom_table_name&apos;,

  // Enable optimistic locking.  When enabled, sequelize will add a version count attribute
  // to the model and throw an OptimisticLockingError error when stale instances are saved.
  // Set to true or a string with the attribute name you want to use to enable.
  version: true
})</code>
</code></pre><p>If you want sequelize to handle timestamps, but only want some of them, or want your timestamps to be called something else, you can override each column individually:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Foo = sequelize.define(&apos;foo&apos;,  { /* bla */ }, {
  // don&apos;t forget to enable timestamps!
  timestamps: true,

  // I don&apos;t want createdAt
  createdAt: false,

  // I want updatedAt to actually be called updateTimestamp
  updatedAt: &apos;updateTimestamp&apos;,

  // And deletedAt to be called destroyTime (remember to enable paranoid for this to work)
  deletedAt: &apos;destroyTime&apos;,
  paranoid: true
})</code>
</code></pre><p>You can also change the database engine, e.g. to MyISAM. InnoDB is the default.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Person = sequelize.define(&apos;person&apos;, { /* attributes */ }, {
  engine: &apos;MYISAM&apos;
})

// or globally
var sequelize = new Sequelize(db, user, pw, {
  define: { engine: &apos;MYISAM&apos; }
})</code>
</code></pre><p>Finally you can specify a comment for the table in MySQL and PG</p><pre><code class="lang-js"><code class="source-code prettyprint">var Person = sequelize.define(&apos;person&apos;, { /* attributes */ }, {
  comment: &quot;I&apos;m a table comment!&quot;
})</code>
</code></pre><h2>Import</h2><p>You can also store your model definitions in a single file using the <code>import</code> method. The returned object is exactly the same as defined in the imported file&apos;s function. Since <code>v1:5.0</code> of Sequelize the import is cached, so you won&apos;t run into troubles when calling the import of a file twice or more often.</p><pre><code class="lang-js"><code class="source-code prettyprint">// in your server file - e.g. app.js
var Project = sequelize.import(__dirname + &quot;/path/to/models/project&quot;)

// The model definition is done in /path/to/models/project.js
// As you might notice, the DataTypes are the very same as explained above
module.exports = function(sequelize, DataTypes) {
  return sequelize.define(&quot;project&quot;, {
    name: DataTypes.STRING,
    description: DataTypes.TEXT
  })
}</code>
</code></pre><p>The <code>import</code> method can also accept a callback as an argument.</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.import(&apos;project&apos;, function(sequelize, DataTypes) {
  return sequelize.define(&quot;project&quot;, {
    name: DataTypes.STRING,
    description: DataTypes.TEXT
  })
})</code>
</code></pre><h2>Optimistic Locking</h2><p>Sequelize has built-in support for optimistic locking through a model instance version count.
Optimistic locking is disabled by default and can be enabled by setting the <code>version</code> property to true in a specific model definition or global model configuration.  See <a href="#configuration">model configuration</a> for more details.</p><p>Optimistic locking allows concurrent access to model records for edits and prevents conflicts from overwriting data.  It does this by checking whether another process has made changes to a record since it was read and throws an OptimisticLockError when a conflict is detected.</p><h2>Database synchronization</h2><p>When starting a new project you won&apos;t have a database structure and using Sequelize you won&apos;t need to. Just specify your model structures and let the library do the rest. Currently supported is the creation and deletion of tables:</p><pre><code class="lang-js"><code class="source-code prettyprint">// Create the tables:
Project.sync()
Task.sync()

// Force the creation!
Project.sync({force: true}) // this will drop the table first and re-create it afterwards

// drop the tables:
Project.drop()
Task.drop()

// event handling:
Project.[sync|drop]().then(function() {
  // ok ... everything is nice!
}).catch(function(error) {
  // oooh, did you enter wrong database credentials?
})</code>
</code></pre><p>Because synchronizing and dropping all of your tables might be a lot of lines to write, you can also let Sequelize do the work for you:</p><pre><code class="lang-js"><code class="source-code prettyprint">// Sync all models that aren&apos;t already in the database
sequelize.sync()

// Force sync all models
sequelize.sync({force: true})

// Drop all tables
sequelize.drop()

// emit handling:
sequelize.[sync|drop]().then(function() {
  // woot woot
}).catch(function(error) {
  // whooops
})</code>
</code></pre><p>Because <code>.sync({ force: true })</code> is destructive operation, you can use <code>match</code> option as an additional safety check.
<code>match</code> option tells sequelize to match a regex against the database name before syncing - a safety check for cases
where <code>force: true</code> is used in tests but not live code.</p><pre><code class="lang-js"><code class="source-code prettyprint">// This will run .sync() only if database name ends with &apos;_test&apos;
sequelize.sync({ force: true, match: /_test$/ });</code>
</code></pre><h2>Expansion of models</h2><p>Sequelize Models are ES6 classes. You can very easily add custom instance or class level methods.</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = sequelize.define(&apos;user&apos;, { firstname: Sequelize.STRING });

// Adding a class level method
User.classLevelMethod = function() {
  return &apos;foo&apos;;
};

// Adding an instance level method
User.prototype.instanceLevelMethod = function() {
  return &apos;bar&apos;;
};</code>
</code></pre><p>Of course you can also access the instance&apos;s data and generate virtual getters:</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = sequelize.define(&apos;user&apos;, { firstname: Sequelize.STRING, lastname: Sequelize.STRING });

User.prototype.getFullname = function() {
  return [this.firstname, this.lastname].join(&apos; &apos;);
};

// Example:
User.build({ firstname: &apos;foo&apos;, lastname: &apos;bar&apos; }).getFullname() // &apos;foo bar&apos;</code>
</code></pre><h3>Indexes</h3><p>Sequelize supports adding indexes to the model definition which will be created during <code>Model.sync()</code> or <code>sequelize.sync</code>.</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.define(&apos;user&apos;, {}, {
  indexes: [
    // Create a unique index on poem
    {
      unique: true,
      fields: [&apos;poem&apos;]
    },

    // Creates a gin index on data with the jsonb_path_ops operator
    {
      fields: [&apos;data&apos;],
      using: &apos;gin&apos;,
      operator: &apos;jsonb_path_ops&apos;
    },

    // By default index name will be [table]_[fields]
    // Creates a multi column partial index
    {
      name: &apos;public_by_author&apos;,
      fields: [&apos;author&apos;, &apos;status&apos;],
      where: {
        status: &apos;public&apos;
      }
    },

    // A BTREE index with a ordered field
    {
      name: &apos;title_index&apos;,
      method: &apos;BTREE&apos;,
      fields: [&apos;author&apos;, {attribute: &apos;title&apos;, collate: &apos;en_US&apos;, order: &apos;DESC&apos;, length: 5}]
    }
  ]
})</code>
</code></pre></div>
        <a data-ice="link" href="manual/tutorial/models-definition.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">Model usage</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Model usage</h1><h2>Data retrieval / Finders</h2><p>Finder methods are intended to query data from the database. They do <em>not</em> return plain objects but instead return model instances. Because finder methods return model instances you can call any model instance member on the result as described in the documentation for <a href="http://docs.sequelizejs.com/en/latest/docs/instances/"><em>instances</em></a>.</p><p>In this document we&apos;ll explore what finder methods can do:</p><h3>find - Search for one specific element in the database</h3><pre><code class="lang-js"><code class="source-code prettyprint">// search for known ids
Project.findById(123).then(function(project) {
  // project will be an instance of Project and stores the content of the table entry
  // with id 123. if such an entry is not defined you will get null
})

// search for attributes
Project.findOne({ where: {title: &apos;aProject&apos;} }).then(function(project) {
  // project will be the first entry of the Projects table with the title &apos;aProject&apos; || null
})


Project.findOne({
  where: {title: &apos;aProject&apos;},
  attributes: [&apos;id&apos;, [&apos;name&apos;, &apos;title&apos;]]
}).then(function(project) {
  // project will be the first entry of the Projects table with the title &apos;aProject&apos; || null
  // project.title will contain the name of the project
})</code>
</code></pre><h3>findOrCreate - Search for a specific element or create it if not available</h3><p>The method <code>findOrCreate</code> can be used to check if a certain element already exists in the database. If that is the case the method will result in a respective instance. If the element does not yet exist, it will be created.</p><p>Let&apos;s assume we have an empty database with a <code>User</code> model which has a <code>username</code> and a <code>job</code>.</p><pre><code class="lang-js"><code class="source-code prettyprint">User
  .findOrCreate({where: {username: &apos;sdepold&apos;}, defaults: {job: &apos;Technical Lead JavaScript&apos;}})
  .spread(function(user, created) {
    console.log(user.get({
      plain: true
    }))
    console.log(created)

    /*
      {
        username: &apos;sdepold&apos;,
        job: &apos;Technical Lead JavaScript&apos;,
        id: 1,
        createdAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET),
        updatedAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET)
      }
      created: true
    */
  })</code>
</code></pre><p>The code created a new instance. So when we already have an instance ...</p><pre><code class="lang-js"><code class="source-code prettyprint">User
  .create({ username: &apos;fnord&apos;, job: &apos;omnomnom&apos; })
  .then(function() {
    User
      .findOrCreate({where: {username: &apos;fnord&apos;}, defaults: {job: &apos;something else&apos;}})
      .spread(function(user, created) {
        console.log(user.get({
          plain: true
        }))
        console.log(created)

        /*
          {
            username: &apos;fnord&apos;,
            job: &apos;omnomnom&apos;,
            id: 2,
            createdAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET),
            updatedAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET)
          }
          created: false
        */
      })
  })</code>
</code></pre><p>... the existing entry will not be changed. See the <code>job</code> of the second user, and the fact that created was false.</p><h3>findAndCountAll - Search for multiple elements in the database, returns both data and total count</h3><p>This is a convenience method that combines<code>findAll</code> and <code>count</code> (see below) this is useful when dealing with queries related to pagination where you want to retrieve data with a <code>limit</code> and <code>offset</code> but also need to know the total number of records that match the query:</p><p>The success handler will always receive an object with two properties:</p><ul>
<li><code>count</code> - an integer, total number records matching the where clause</li>
<li><code>rows</code> - an array of objects, the records matching the where clause, within the limit and offset range<pre><code class="lang-js"><code class="source-code prettyprint">Project
.findAndCountAll({
   where: {
      title: {
        $like: &apos;foo%&apos;
      }
   },
   offset: 10,
   limit: 2
})
.then(function(result) {
  console.log(result.count);
  console.log(result.rows);
});</code>
</code></pre>
</li>
</ul><p><code>findAndCountAll</code> also supports includes. Only the includes that are marked as <code>required</code> will be added to the count part:</p><p>Suppose you want to find all users who have a profile attached:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAndCountAll({
  include: [
     { model: Profile, required: true}
  ],
  limit: 3
});</code>
</code></pre><p>Because the include for <code>Profile</code> has <code>required</code> set it will result in an inner join, and only the users who have a profile will be counted. If we remove <code>required</code> from the include, both users with and without profiles will be counted. Adding a <code>where</code> clause to the include automatically makes it required:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAndCountAll({
  include: [
     { model: Profile, where: { active: true }}
  ],
  limit: 3
});</code>
</code></pre><p>The query above will only count users who have an active profile, because <code>required</code> is implicitly set to true when you add a where clause to the include.</p><p>The options object that you pass to <code>findAndCountAll</code> is the same as for <code>findAll</code> (described below).</p><h3>findAll - Search for multiple elements in the database</h3><pre><code class="lang-js"><code class="source-code prettyprint">// find multiple entries
Project.findAll().then(function(projects) {
  // projects will be an array of all Project instances
})

// also possible:
Project.all().then(function(projects) {
  // projects will be an array of all Project instances
})

// search for specific attributes - hash usage
Project.findAll({ where: { name: &apos;A Project&apos; } }).then(function(projects) {
  // projects will be an array of Project instances with the specified name
})

// search with string replacements
Project.findAll({ where: [&quot;id &gt; ?&quot;, 25] }).then(function(projects) {
  // projects will be an array of Projects having a greater id than 25
})

// search within a specific range
Project.findAll({ where: { id: [1,2,3] } }).then(function(projects) {
  // projects will be an array of Projects having the id 1, 2 or 3
  // this is actually doing an IN query
})

Project.findAll({
  where: {
    id: {
      $and: {a: 5}           // AND (a = 5)
      $or: [{a: 5}, {a: 6}]  // (a = 5 OR a = 6)
      $gt: 6,                // id &gt; 6
      $gte: 6,               // id &gt;= 6
      $lt: 10,               // id &lt; 10
      $lte: 10,              // id &lt;= 10
      $ne: 20,               // id != 20
      $between: [6, 10],     // BETWEEN 6 AND 10
      $notBetween: [11, 15], // NOT BETWEEN 11 AND 15
      $in: [1, 2],           // IN [1, 2]
      $notIn: [1, 2],        // NOT IN [1, 2]
      $like: &apos;%hat&apos;,         // LIKE &apos;%hat&apos;
      $notLike: &apos;%hat&apos;       // NOT LIKE &apos;%hat&apos;
      $iLike: &apos;%hat&apos;         // ILIKE &apos;%hat&apos; (case insensitive)  (PG only)
      $notILike: &apos;%hat&apos;      // NOT ILIKE &apos;%hat&apos;  (PG only)
      $overlap: [1, 2]       // &amp;&amp; [1, 2] (PG array overlap operator)
      $contains: [1, 2]      // @&gt; [1, 2] (PG array contains operator)
      $contained: [1, 2]     // &lt;@ [1, 2] (PG array contained by operator)
      $any: [2,3]            // ANY ARRAY[2, 3]::INTEGER (PG only)
    },
    status: {
      $not: false,           // status NOT FALSE
    }
  }
})</code>
</code></pre><h3>Complex filtering / OR / NOT queries</h3><p>It&apos;s possible to do complex where queries with multiple levels of nested AND, OR and NOT conditions. In order to do that you can use <code>$or</code>, <code>$and</code> or <code>$not</code>:</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.findOne({
  where: {
    name: &apos;a project&apos;,
    $or: [
      { id: [1,2,3] },
      { id: { $gt: 10 } }
    ]
  }
})

Project.findOne({
  where: {
    name: &apos;a project&apos;,
    id: {
      $or: [
        [1,2,3],
        { $gt: 10 }
      ]
    }
  }
})</code>
</code></pre><p>Both pieces of code will generate the following:</p><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT *
FROM `Projects`
WHERE (
  `Projects`.`name` = &apos;a project&apos;
   AND (`Projects`.`id` IN (1,2,3) OR `Projects`.`id` &gt; 10)
)
LIMIT 1;</code>
</code></pre><p><code>$not</code> example:</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.findOne({
  where: {
    name: &apos;a project&apos;,
    $not: [
      { id: [1,2,3] },
      { array: { $contains: [3,4,5] } }
    ]
  }
});</code>
</code></pre><p>Will generate:</p><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT *
FROM `Projects`
WHERE (
  `Projects`.`name` = &apos;a project&apos;
   AND NOT (`Projects`.`id` IN (1,2,3) OR `Projects`.`array` @&gt; ARRAY[1,2,3]::INTEGER[])
)
LIMIT 1;</code>
</code></pre><h3>Manipulating the dataset with limit, offset, order and group</h3><p>To get more relevant data, you can use limit, offset, order and grouping:</p><pre><code class="lang-js"><code class="source-code prettyprint">// limit the results of the query
Project.findAll({ limit: 10 })

// step over the first 10 elements
Project.findAll({ offset: 10 })

// step over the first 10 elements, and take 2
Project.findAll({ offset: 10, limit: 2 })</code>
</code></pre><p>The syntax for grouping and ordering are equal, so below it is only explained with a single example for group, and the rest for order. Everything you see below can also be done for group</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.findAll({order: &apos;title DESC&apos;})
// yields ORDER BY title DESC

Project.findAll({group: &apos;name&apos;})
// yields GROUP BY name</code>
</code></pre><p>Notice how in the two examples above, the string provided is inserted verbatim into the query, i.e. column names are not escaped. When you provide a string to order/group, this will always be the case. If you want to escape column names, you should provide an array of arguments, even though you only want to order/group by a single column</p><pre><code class="lang-js"><code class="source-code prettyprint">something.findOne({
  order: [
    &apos;name&apos;,
    // will return `name`
    &apos;username DESC&apos;,
    // will return `username DESC` -- i.e. don&apos;t do it!
    [&apos;username&apos;, &apos;DESC&apos;],
    // will return `username` DESC
    sequelize.fn(&apos;max&apos;, sequelize.col(&apos;age&apos;)),
    // will return max(`age`)
    [sequelize.fn(&apos;max&apos;, sequelize.col(&apos;age&apos;)), &apos;DESC&apos;],
    // will return max(`age`) DESC
    [sequelize.fn(&apos;otherfunction&apos;, sequelize.col(&apos;col1&apos;), 12, &apos;lalala&apos;), &apos;DESC&apos;],
    // will return otherfunction(`col1`, 12, &apos;lalala&apos;) DESC
    [sequelize.fn(&apos;otherfunction&apos;, sequelize.fn(&apos;awesomefunction&apos;, sequelize.col(&apos;col&apos;))), &apos;DESC&apos;]
    // will return otherfunction(awesomefunction(`col`)) DESC, This nesting is potentially infinite!
    [{ raw: &apos;otherfunction(awesomefunction(`col`))&apos; }, &apos;DESC&apos;]
    // This won&apos;t be quoted, but direction will be added
  ]
})</code>
</code></pre><p>To recap, the elements of the order/group array can be the following:</p><ul>
<li>String - will be quoted</li>
<li>Array - first element will be quoted, second will be appended verbatim</li>
<li>Object -<ul>
<li>Raw will be added verbatim without quoting</li>
<li>Everything else is ignored, and if raw is not set, the query will fail</li>
</ul>
</li>
<li>Sequelize.fn and Sequelize.col returns functions and quoted cools</li>
</ul><h3>Raw queries</h3><p>Sometimes you might be expecting a massive dataset that you just want to display, without manipulation. For each row you select, Sequelize creates an instance with functions for update, delete, get associations etc. If you have thousands of rows, this might take some time. If you only need the raw data and don&apos;t want to update anything, you can do like this to get the raw data.</p><pre><code class="lang-js"><code class="source-code prettyprint">// Are you expecting a massive dataset from the DB,
// and don&apos;t want to spend the time building DAOs for each entry?
// You can pass an extra query option to get the raw data instead:
Project.findAll({ where: { ... }, raw: true })</code>
</code></pre><h3>count - Count the occurrences of elements in the database</h3><p>There is also a method for counting database objects:</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.count().then(function(c) {
  console.log(&quot;There are &quot; + c + &quot; projects!&quot;)
})

Project.count({ where: [&quot;id &gt; ?&quot;, 25] }).then(function(c) {
  console.log(&quot;There are &quot; + c + &quot; projects with an id greater than 25.&quot;)
})</code>
</code></pre><h3>max - Get the greatest value of a specific attribute within a specific table</h3><p>And here is a method for getting the max value of an attribute:f</p><pre><code class="lang-js"><code class="source-code prettyprint">/*
  Let&apos;s assume 3 person objects with an attribute age.
  The first one is 10 years old,
  the second one is 5 years old,
  the third one is 40 years old.
*/
Project.max(&apos;age&apos;).then(function(max) {
  // this will return 40
})

Project.max(&apos;age&apos;, { where: { age: { lt: 20 } } }).then(function(max) {
  // will be 10
})</code>
</code></pre><h3>min - Get the least value of a specific attribute within a specific table</h3><p>And here is a method for getting the min value of an attribute:</p><pre><code class="lang-js"><code class="source-code prettyprint">/*
  Let&apos;s assume 3 person objects with an attribute age.
  The first one is 10 years old,
  the second one is 5 years old,
  the third one is 40 years old.
*/
Project.min(&apos;age&apos;).then(function(min) {
  // this will return 5
})

Project.min(&apos;age&apos;, { where: { age: { $gt: 5 } } }).then(function(min) {
  // will be 10
})</code>
</code></pre><h3>sum - Sum the value of specific attributes</h3><p>In order to calculate the sum over a specific column of a table, you can
use the <code>sum</code> method.</p><pre><code class="lang-js"><code class="source-code prettyprint">/*
  Let&apos;s assume 3 person objects with an attribute age.
  The first one is 10 years old,
  the second one is 5 years old,
  the third one is 40 years old.
*/
Project.sum(&apos;age&apos;).then(function(sum) {
  // this will return 55
})

Project.sum(&apos;age&apos;, { where: { age: { $gt: 5 } } }).then(function(sum) {
  // will be 50
})</code>
</code></pre><h2>Eager loading</h2><p>When you are retrieving data from the database there is a fair chance that you also want to get associations with the same query - this is called eager loading. The basic idea behind that, is the use of the attribute <code>include</code> when you are calling <code>find</code> or <code>findAll</code>. Lets assume the following setup:</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = sequelize.define(&apos;user&apos;, { name: Sequelize.STRING })
  , Task = sequelize.define(&apos;task&apos;, { name: Sequelize.STRING })
  , Tool = sequelize.define(&apos;tool&apos;, { name: Sequelize.STRING })

Task.belongsTo(User)
User.hasMany(Task)
User.hasMany(Tool, { as: &apos;Instruments&apos; })

sequelize.sync().then(function() {
  // this is where we continue ...
})</code>
</code></pre><p>OK. So, first of all, let&apos;s load all tasks with their associated user.</p><pre><code class="lang-js"><code class="source-code prettyprint">Task.findAll({ include: [ User ] }).then(function(tasks) {
  console.log(JSON.stringify(tasks))

  /*
    [{
      &quot;name&quot;: &quot;A Task&quot;,
      &quot;id&quot;: 1,
      &quot;createdAt&quot;: &quot;2013-03-20T20:31:40.000Z&quot;,
      &quot;updatedAt&quot;: &quot;2013-03-20T20:31:40.000Z&quot;,
      &quot;userId&quot;: 1,
      &quot;user&quot;: {
        &quot;name&quot;: &quot;John Doe&quot;,
        &quot;id&quot;: 1,
        &quot;createdAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
        &quot;updatedAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;
      }
    }]
  */
})</code>
</code></pre><p>Notice that the accessor (the <code>User</code> property in the resulting instance) is singular because the association is one-to-something.</p><p>Next thing: Loading of data with many-to-something associations!</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({ include: [ Task ] }).then(function(users) {
  console.log(JSON.stringify(users))

  /*
    [{
      &quot;name&quot;: &quot;John Doe&quot;,
      &quot;id&quot;: 1,
      &quot;createdAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;updatedAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;tasks&quot;: [{
        &quot;name&quot;: &quot;A Task&quot;,
        &quot;id&quot;: 1,
        &quot;createdAt&quot;: &quot;2013-03-20T20:31:40.000Z&quot;,
        &quot;updatedAt&quot;: &quot;2013-03-20T20:31:40.000Z&quot;,
        &quot;userId&quot;: 1
      }]
    }]
  */
})</code>
</code></pre><p>Notice that the accessor (the <code>Tasks</code> property in the resulting instance) is plural because the association is many-to-something.</p><p>If an association is aliased (using the <code>as</code> option), you must specify this alias when including the model. Notice how the user&apos;s <code>Tool</code>s are aliased as <code>Instruments</code> above. In order to get that right you have to specify the model you want to load, as well as the alias:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({ include: [{ model: Tool, as: &apos;Instruments&apos; }] }).then(function(users) {
  console.log(JSON.stringify(users))

  /*
    [{
      &quot;name&quot;: &quot;John Doe&quot;,
      &quot;id&quot;: 1,
      &quot;createdAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;updatedAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;Instruments&quot;: [{
        &quot;name&quot;: &quot;Toothpick&quot;,
        &quot;id&quot;: 1,
        &quot;createdAt&quot;: null,
        &quot;updatedAt&quot;: null,
        &quot;userId&quot;: 1
      }]
    }]
  */
})</code>
</code></pre><p>You can also include by alias name by specifying a string that matches the association alias:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({ include: [&apos;Instruments&apos;] }).then(function(users) {
  console.log(JSON.stringify(users))

  /*
    [{
      &quot;name&quot;: &quot;John Doe&quot;,
      &quot;id&quot;: 1,
      &quot;createdAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;updatedAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;Instruments&quot;: [{
        &quot;name&quot;: &quot;Toothpick&quot;,
        &quot;id&quot;: 1,
        &quot;createdAt&quot;: null,
        &quot;updatedAt&quot;: null,
        &quot;userId&quot;: 1
      }]
    }]
  */
})

User.findAll({ include: [{ association: &apos;Instruments&apos; }] }).then(function(users) {
  console.log(JSON.stringify(users))

  /*
    [{
      &quot;name&quot;: &quot;John Doe&quot;,
      &quot;id&quot;: 1,
      &quot;createdAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;updatedAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;Instruments&quot;: [{
        &quot;name&quot;: &quot;Toothpick&quot;,
        &quot;id&quot;: 1,
        &quot;createdAt&quot;: null,
        &quot;updatedAt&quot;: null,
        &quot;userId&quot;: 1
      }]
    }]
  */
})</code>
</code></pre><p>When eager loading we can also filter the associated model using <code>where</code>. This will return all <code>User</code>s in which the <code>where</code> clause of <code>Tool</code> model matches rows.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({
    include: [{
        model: Tool,
        as: &apos;Instruments&apos;,
        where: { name: { $like: &apos;%ooth%&apos; } }
    }]
}).then(function(users) {
    console.log(JSON.stringify(users))

    /*
      [{
        &quot;name&quot;: &quot;John Doe&quot;,
        &quot;id&quot;: 1,
        &quot;createdAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
        &quot;updatedAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
        &quot;Instruments&quot;: [{
          &quot;name&quot;: &quot;Toothpick&quot;,
          &quot;id&quot;: 1,
          &quot;createdAt&quot;: null,
          &quot;updatedAt&quot;: null,
          &quot;userId&quot;: 1
        }]
      }],

      [{
        &quot;name&quot;: &quot;John Smith&quot;,
        &quot;id&quot;: 2,
        &quot;createdAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
        &quot;updatedAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
        &quot;Instruments&quot;: [{
          &quot;name&quot;: &quot;Toothpick&quot;,
          &quot;id&quot;: 1,
          &quot;createdAt&quot;: null,
          &quot;updatedAt&quot;: null,
          &quot;userId&quot;: 1
        }]
      }],
    */
  })</code>
</code></pre><p>When an eager loaded model is filtered using <code>include.where</code> then <code>include.required</code> is implicitly set to
<code>true</code>. This means that an inner join is done returning parent models with any matching children.</p><h3>Including everything</h3><p>To include all attributes, you can pass a single object with <code>all: true</code>:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({ include: [{ all: true }]});</code>
</code></pre><h3>Including soft deleted records</h3><p>In case you want to eager load soft deleted records you can do that by setting <code>include.paranoid</code> to <code>true</code></p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({
    include: [{
        model: Tool,
        where: { name: { $like: &apos;%ooth%&apos; } },
        paranoid: true // query and loads the soft deleted records
    }]
});</code>
</code></pre><h3>Ordering Eager Loaded Associations</h3><p>In the case of a one-to-many relationship.</p><pre><code class="lang-js"><code class="source-code prettyprint">Company.findAll({ include: [ Division ], order: [ [ Division, &apos;name&apos; ] ] });
Company.findAll({ include: [ Division ], order: [ [ Division, &apos;name&apos;, &apos;DESC&apos; ] ] });
Company.findAll({
  include: [ { model: Division, as: &apos;Div&apos; } ],
  order: [ [ { model: Division, as: &apos;Div&apos; }, &apos;name&apos; ] ]
});
Company.findAll({
  include: [ { model: Division, as: &apos;Div&apos; } ],
  order: [ [ { model: Division, as: &apos;Div&apos; }, &apos;name&apos;, &apos;DESC&apos; ] ]
});
Company.findAll({
  include: [ { model: Division, include: [ Department ] } ],
  order: [ [ Division, Department, &apos;name&apos; ] ]
});</code>
</code></pre><p>In the case of many-to-many joins, you are also able to sort by attributes in the through table.</p><pre><code class="lang-js"><code class="source-code prettyprint">Company.findAll({
  include: [ { model: Division, include: [ Department ] } ],
  order: [ [ Division, DepartmentDivision, &apos;name&apos; ] ]
});</code>
</code></pre><h3>Nested eager loading</h3><p>You can use nested eager loading to load all related models of a related model:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({
  include: [
    {model: Tool, as: &apos;Instruments&apos;, include: [
      {model: Teacher, include: [ /* etc */]}
    ]}
  ]
}).then(function(users) {
  console.log(JSON.stringify(users))

  /*
    [{
      &quot;name&quot;: &quot;John Doe&quot;,
      &quot;id&quot;: 1,
      &quot;createdAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;updatedAt&quot;: &quot;2013-03-20T20:31:45.000Z&quot;,
      &quot;Instruments&quot;: [{ // 1:M and N:M association
        &quot;name&quot;: &quot;Toothpick&quot;,
        &quot;id&quot;: 1,
        &quot;createdAt&quot;: null,
        &quot;updatedAt&quot;: null,
        &quot;userId&quot;: 1,
        &quot;Teacher&quot;: { // 1:1 association
          &quot;name&quot;: &quot;Jimi Hendrix&quot;
        }
      }]
    }]
  */
})</code>
</code></pre><p>This will produce an outer join. However, a <code>where</code> clause on a related model will create an inner join and return only the instances that have matching sub-models. To return all parent instances, you should add <code>required: false</code>.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({
  include: [{
    model: Tool,
    as: &apos;Instruments&apos;,
    include: [{
      model: Teacher,
      where: {
        school: &quot;Woodstock Music School&quot;
      },
      required: false
    }]
  }]
}).then(function(users) {
  /* ... */
})</code>
</code></pre><p>The query above will return all users, and all their instruments, but only those teachers associated with <code>Woodstock Music School</code>.</p><p>Include all also supports nested loading:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({ include: [{ all: true, nested: true }]});</code>
</code></pre></div>
        <a data-ice="link" href="manual/tutorial/models-usage.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">Querying</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Querying</h1><h2>Attributes</h2><p>To select only some attributes, you can use the <code>attributes</code> option. Most often, you pass an array:</p><pre><code class="lang-js"><code class="source-code prettyprint">Model.findAll({
  attributes: [&apos;foo&apos;, &apos;bar&apos;]
});</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT foo, bar ...</code>
</code></pre><p>Attributes can be renamed using a nested array:</p><pre><code class="lang-js"><code class="source-code prettyprint">Model.findAll({
  attributes: [&apos;foo&apos;, [&apos;bar&apos;, &apos;baz&apos;]]
});</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT foo, bar AS baz ...</code>
</code></pre><p>You can use <code>sequelize.fn</code> to do aggregations:</p><pre><code class="lang-js"><code class="source-code prettyprint">Model.findAll({
  attributes: [[sequelize.fn(&apos;COUNT&apos;, sequelize.col(&apos;hats&apos;)), &apos;no_hats&apos;]]
});</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT COUNT(hats) AS no_hats ...</code>
</code></pre><p>When using aggregation function, you must give it an alias to be able to access it from the model. In the example above you can get the number of hats with <code>instance.get(&apos;no_hats&apos;)</code>.</p><p>Sometimes it may be tiresome to list all the attributes of the model if you only want to add an aggregation:</p><pre><code class="lang-js"><code class="source-code prettyprint">// This is a tiresome way of getting the number of hats...
Model.findAll({
  attributes: [&apos;id&apos;, &apos;foo&apos;, &apos;bar&apos;, &apos;baz&apos;, &apos;quz&apos;, [sequelize.fn(&apos;COUNT&apos;, sequelize.col(&apos;hats&apos;)), &apos;no_hats&apos;]]
});

// This is shorter, and less error prone because it still works if you add / remove attributes
Model.findAll({
  attributes: { include: [[sequelize.fn(&apos;COUNT&apos;, sequelize.col(&apos;hats&apos;)), &apos;no_hats&apos;]] }
});</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT id, foo, bar, baz, quz, COUNT(hats) AS no_hats ...</code>
</code></pre><p>Similarly, its also possible to remove a selected few attributes:</p><pre><code class="lang-js"><code class="source-code prettyprint">Model.findAll({
  attributes: { exclude: [&apos;baz&apos;] }
});</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT id, foo, bar, quz ...</code>
</code></pre><h2>Where</h2><p>Whether you are querying with findAll/find or doing bulk updates/destroys you can pass a <code>where</code> object to filter the query.</p><p><code>where</code> generally takes an object from attribute:value pairs, where value can be primitives for equality matches or keyed objects for other operators.</p><p>It&apos;s also possible to generate complex AND/OR conditions by nesting sets of <code>$or</code> and <code>$and</code>.</p><h3>Basics</h3><pre><code class="lang-js"><code class="source-code prettyprint">Post.findAll({
  where: {
    authorId: 2
  }
});
// SELECT * FROM post WHERE authorId = 2

Post.findAll({
  where: {
    authorId: 12,
    status: &apos;active&apos;
  }
});
// SELECT * FROM post WHERE authorId = 12 AND status = &apos;active&apos;;

Post.destroy({
  where: {
    status: &apos;inactive&apos;
  }
});
// DELETE FROM post WHERE status = &apos;inactive&apos;;

Post.update({
  updatedAt: null,
}, {
  where: {
    deletedAt: {
      $ne: null
    }
  }
});
// UPDATE post SET updatedAt = null WHERE deletedAt NOT NULL;

Post.findAll({
  where: sequelize.where(sequelize.fn(&apos;char_length&apos;, sequelize.col(&apos;status&apos;)), 6)
});
// SELECT * FROM post WHERE char_length(status) = 6;</code>
</code></pre><h3>Operators</h3><pre><code class="lang-js"><code class="source-code prettyprint">$and: {a: 5}           // AND (a = 5)
$or: [{a: 5}, {a: 6}]  // (a = 5 OR a = 6)
$gt: 6,                // &gt; 6
$gte: 6,               // &gt;= 6
$lt: 10,               // &lt; 10
$lte: 10,              // &lt;= 10
$ne: 20,               // != 20
$eq: 3,                // = 3
$not: true,            // IS NOT TRUE
$between: [6, 10],     // BETWEEN 6 AND 10
$notBetween: [11, 15], // NOT BETWEEN 11 AND 15
$in: [1, 2],           // IN [1, 2]
$notIn: [1, 2],        // NOT IN [1, 2]
$like: &apos;%hat&apos;,         // LIKE &apos;%hat&apos;
$notLike: &apos;%hat&apos;       // NOT LIKE &apos;%hat&apos;
$iLike: &apos;%hat&apos;         // ILIKE &apos;%hat&apos; (case insensitive) (PG only)
$notILike: &apos;%hat&apos;      // NOT ILIKE &apos;%hat&apos;  (PG only)
$like: { $any: [&apos;cat&apos;, &apos;hat&apos;]}
                       // LIKE ANY ARRAY[&apos;cat&apos;, &apos;hat&apos;] - also works for iLike and notLike
$overlap: [1, 2]       // &amp;&amp; [1, 2] (PG array overlap operator)
$contains: [1, 2]      // @&gt; [1, 2] (PG array contains operator)
$contained: [1, 2]     // &lt;@ [1, 2] (PG array contained by operator)
$any: [2,3]            // ANY ARRAY[2, 3]::INTEGER (PG only)

$col: &apos;user.organization_id&apos; // = &quot;user&quot;.&quot;organization_id&quot;, with dialect specific column identifiers, PG in this example</code>
</code></pre><h3>Range Operators</h3><p>Range types can be queried with all supported operators.</p><p>Keep in mind, the provided range value can
<a href="./manual/models-definition/#range-types">define the bound inclusion/exclusion</a>
as well.</p><pre><code class="lang-js"><code class="source-code prettyprint">// All the above equality and inequality operators plus the following:

$contains: 2           // @&gt; &apos;2&apos;::integer (PG range contains element operator)
$contains: [1, 2]      // @&gt; [1, 2) (PG range contains range operator)
$contained: [1, 2]     // &lt;@ [1, 2) (PG range is contained by operator)
$overlap: [1, 2]       // &amp;&amp; [1, 2) (PG range overlap (have points in common) operator)
$adjacent: [1, 2]      // -|- [1, 2) (PG range is adjacent to operator)
$strictLeft: [1, 2]    // &lt;&lt; [1, 2) (PG range strictly left of operator)
$strictRight: [1, 2]   // &gt;&gt; [1, 2) (PG range strictly right of operator)
$noExtendRight: [1, 2] // &amp;&lt; [1, 2) (PG range does not extend to the right of operator)
$noExtendLeft: [1, 2]  // &amp;&gt; [1, 2) (PG range does not extend to the left of operator)</code>
</code></pre><h3>Combinations</h3><pre><code class="lang-js"><code class="source-code prettyprint">{
  rank: {
    $or: {
      $lt: 1000,
      $eq: null
    }
  }
}
// rank &lt; 1000 OR rank IS NULL

{
  createdAt: {
    $lt: new Date(),
    $gt: new Date(new Date() - 24 * 60 * 60 * 1000)
  }
}
// createdAt &lt; [timestamp] AND createdAt &gt; [timestamp]

{
  $or: [
    {
      title: {
        $like: &apos;Boat%&apos;
      }
    },
    {
      description: {
        $like: &apos;%boat%&apos;
      }
    }
  ]
}
// title LIKE &apos;Boat%&apos; OR description LIKE &apos;%boat%&apos;</code>
</code></pre><h3>JSONB</h3><p>JSONB can be queried in three different ways.</p><h4>Nested object</h4><pre><code class="lang-js"><code class="source-code prettyprint">{
  meta: {
    video: {
      url: {
        $ne: null
      }
    }
  }
}</code>
</code></pre><h4>Nested key</h4><pre><code class="lang-js"><code class="source-code prettyprint">{
  &quot;meta.audio.length&quot;: {
    $gt: 20
  }
}</code>
</code></pre><h4>Containment</h4><pre><code class="lang-js"><code class="source-code prettyprint">{
  &quot;meta&quot;: {
    $contains: {
      site: {
        url: &apos;http://google.com&apos;
      }
    }
  }
}</code>
</code></pre><h3>Relations / Associations</h3><pre><code class="lang-js"><code class="source-code prettyprint">// Find all projects with a least one task where task.state === project.state
Project.findAll({
    include: [{
        model: Task,
        where: { state: Sequelize.col(&apos;project.state&apos;) }
    }]
})</code>
</code></pre><h2>Pagination / Limiting</h2><pre><code class="lang-js"><code class="source-code prettyprint">// Fetch 10 instances/rows
Project.findAll({ limit: 10 })

// Skip 8 instances/rows
Project.findAll({ offset: 8 })

// Skip 5 instances and fetch the 5 after that
Project.findAll({ offset: 5, limit: 5 })</code>
</code></pre><h2>Ordering</h2><p><code>order</code> takes an array of items to order the query by or a sequelize method. Generally you will want to use a tuple/array of either attribute, direction or just direction to ensure proper escaping.</p><pre><code class="lang-js"><code class="source-code prettyprint">something.findOne({
  order: [
    // Will escape username and validate DESC against a list of valid direction parameters
    [&apos;username&apos;, &apos;DESC&apos;],

    // Will order by max(age)
    sequelize.fn(&apos;max&apos;, sequelize.col(&apos;age&apos;)),

    // Will order by max(age) DESC
    [sequelize.fn(&apos;max&apos;, sequelize.col(&apos;age&apos;)), &apos;DESC&apos;],

    // Will order by  otherfunction(`col1`, 12, &apos;lalala&apos;) DESC
    [sequelize.fn(&apos;otherfunction&apos;, sequelize.col(&apos;col1&apos;), 12, &apos;lalala&apos;), &apos;DESC&apos;],

    // Will order by name on an associated User
    [User, &apos;name&apos;, &apos;DESC&apos;],

    // Will order by name on an associated User aliased as Friend
    [{model: User, as: &apos;Friend&apos;}, &apos;name&apos;, &apos;DESC&apos;],

    // Will order by name on a nested associated Company of an associated User
    [User, Company, &apos;name&apos;, &apos;DESC&apos;],
  ]
  // Will order by max age descending
  order: sequelize.literal(&apos;max(age) DESC&apos;)

  // Will order by max age ascencding assuming ascencding is the default order when direction is omitted
  order: sequelize.fn(&apos;max&apos;, sequelize.col(&apos;age&apos;))

  // Will order by age ascencding assuming ascencding is the default order when direction is omitted
  order: sequelize.col(&apos;age&apos;)
})</code>
</code></pre></div>
        <a data-ice="link" href="manual/tutorial/querying.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">Instances</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Instances</h1><h2>Building a non-persistent instance</h2><p>In order to create instances of defined classes just do as follows. You might recognize the syntax if you coded Ruby in the past. Using the <code>build</code>-method will return an unsaved object, which you explicitly have to save.</p><pre><code class="lang-js"><code class="source-code prettyprint">var project = Project.build({
  title: &apos;my awesome project&apos;,
  description: &apos;woot woot. this will make me a rich man&apos;
})

var task = Task.build({
  title: &apos;specify the project idea&apos;,
  description: &apos;bla&apos;,
  deadline: new Date()
})</code>
</code></pre><p>Built instances will automatically get default values when they were defined:</p><pre><code class="lang-js"><code class="source-code prettyprint">// first define the model
var Task = sequelize.define(&apos;task&apos;, {
  title: Sequelize.STRING,
  rating: { type: Sequelize.STRING, defaultValue: 3 }
})

// now instantiate an object
var task = Task.build({title: &apos;very important task&apos;})

task.title  // ==&gt; &apos;very important task&apos;
task.rating // ==&gt; 3</code>
</code></pre><p>To get it stored in the database, use the <code>save</code>-method and catch the events ... if needed:</p><pre><code class="lang-js"><code class="source-code prettyprint">project.save().then(function() {
  // my nice callback stuff
})

task.save().catch(function(error) {
  // mhhh, wth!
})

// you can also build, save and access the object with chaining:
Task
  .build({ title: &apos;foo&apos;, description: &apos;bar&apos;, deadline: new Date() })
  .save()
  .then(function(anotherTask) {
    // you can now access the currently saved task with the variable anotherTask... nice!
  }).catch(function(error) {
    // Ooops, do some error-handling
  })</code>
</code></pre><h2>Creating persistent instances</h2><p>Besides constructing objects, that needs an explicit save call to get stored in the database, there is also the possibility to do all those steps with one single command. It&apos;s called <code>create</code>.</p><pre><code class="lang-js"><code class="source-code prettyprint">Task.create({ title: &apos;foo&apos;, description: &apos;bar&apos;, deadline: new Date() }).then(function(task) {
  // you can now access the newly created task via the variable task
})</code>
</code></pre><p>It is also possible to define which attributes can be set via the create method. This can be especially very handy if you create database entries based on a form which can be filled by a user. Using that would for example allow you to restrict the <code>User</code> model to set only a username and an address but not an admin flag:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.create({ username: &apos;barfooz&apos;, isAdmin: true }, { fields: [ &apos;username&apos; ] }).then(function(user) {
  // let&apos;s assume the default of isAdmin is false:
  console.log(user.get({
    plain: true
  })) // =&gt; { username: &apos;barfooz&apos;, isAdmin: false }
})</code>
</code></pre><h2>Updating / Saving / Persisting an instance</h2><p>Now lets change some values and save changes to the database... There are two ways to do that:</p><pre><code class="lang-js"><code class="source-code prettyprint">// way 1
task.title = &apos;a very different title now&apos;
task.save().then(function() {})

// way 2
task.update({
  title: &apos;a very different title now&apos;
}).then(function() {})</code>
</code></pre><p>It&apos;s also possible to define which attributes should be saved when calling <code>save</code>, by passing an array of column names. This is useful when you set attributes based on a previously defined object. E.g. if you get the values of an object via a form of a web app. Furthermore this is used internally for <code>update</code>. This is how it looks like:</p><pre><code class="lang-js"><code class="source-code prettyprint">task.title = &apos;foooo&apos;
task.description = &apos;baaaaaar&apos;
task.save({fields: [&apos;title&apos;]}).then(function() {
 // title will now be &apos;foooo&apos; but description is the very same as before
})

// The equivalent call using update looks like this:
task.update({ title: &apos;foooo&apos;, description: &apos;baaaaaar&apos;}, {fields: [&apos;title&apos;]}).then(function() {
 // title will now be &apos;foooo&apos; but description is the very same as before
})</code>
</code></pre><p>When you call <code>save</code> without changing any attribute, this method will execute nothing;</p><h2>Destroying / Deleting persistent instances</h2><p>Once you created an object and got a reference to it, you can delete it from the database. The relevant method is <code>destroy</code>:</p><pre><code class="lang-js"><code class="source-code prettyprint">Task.create({ title: &apos;a task&apos; }).then(function(task) {
  // now you see me...
  return task.destroy();
}).then(function() {
 // now i&apos;m gone :)
})</code>
</code></pre><p>If the <code>paranoid</code> options is true, the object will not be deleted, instead the <code>deletedAt</code> column will be set to the current timestamp. To force the deletion, you can pass <code>force: true</code> to the destroy call:</p><pre><code class="lang-js"><code class="source-code prettyprint">task.destroy({ force: true })</code>
</code></pre><h2>Working in bulk (creating, updating and destroying multiple rows at once)</h2><p>In addition to updating a single instance, you can also create, update, and delete multiple instances at once. The functions you are looking for are called</p><ul>
<li><code>Model.bulkCreate</code></li>
<li><code>Model.update</code></li>
<li><code>Model.destroy</code></li>
</ul><p>Since you are working with multiple models, the callbacks will not return DAO instances. BulkCreate will return an array of model instances/DAOs, they will however, unlike <code>create</code>, not have the resulting values of autoIncrement attributes.<code>update</code> and <code>destroy</code> will return the number of affected rows.</p><p>First lets look at bulkCreate</p><pre><code class="lang-js"><code class="source-code prettyprint">User.bulkCreate([
  { username: &apos;barfooz&apos;, isAdmin: true },
  { username: &apos;foo&apos;, isAdmin: true },
  { username: &apos;bar&apos;, isAdmin: false }
]).then(function() { // Notice: There are no arguments here, as of right now you&apos;ll have to...
  return User.findAll();
}).then(function(users) {
  console.log(users) // ... in order to get the array of user objects
})</code>
</code></pre><p>To update several rows at once:</p><pre><code class="lang-js"><code class="source-code prettyprint">Task.bulkCreate([
  {subject: &apos;programming&apos;, status: &apos;executing&apos;},
  {subject: &apos;reading&apos;, status: &apos;executing&apos;},
  {subject: &apos;programming&apos;, status: &apos;finished&apos;}
]).then(function() {
  return Task.update(
    { status: &apos;inactive&apos; }, /* set attributes&apos; value */,
    { where: { subject: &apos;programming&apos; }} /* where criteria */
  );
}).spread(function(affectedCount, affectedRows) {
  // .update returns two values in an array, therefore we use .spread
  // Notice that affectedRows will only be defined in dialects which support returning: true

  // affectedCount will be 2
  return Task.findAll();
}).then(function(tasks) {
  console.log(tasks) // the &apos;programming&apos; tasks will both have a status of &apos;inactive&apos;
})</code>
</code></pre><p>And delete them:</p><pre><code class="lang-js"><code class="source-code prettyprint">Task.bulkCreate([
  {subject: &apos;programming&apos;, status: &apos;executing&apos;},
  {subject: &apos;reading&apos;, status: &apos;executing&apos;},
  {subject: &apos;programming&apos;, status: &apos;finished&apos;}
]).then(function() {
  return Task.destroy({
    where: {
      subject: &apos;programming&apos;
    },
    truncate: true /* this will ignore where and truncate the table instead */
  });
}).then(function(affectedRows) {
  // affectedRows will be 2
  return Task.findAll();
}).then(function(tasks) {
  console.log(tasks) // no programming, just reading :(
})</code>
</code></pre><p>If you are accepting values directly from the user, it might be beneficial to limit the columns that you want to actually insert.<code>bulkCreate()</code>accepts an options object as the second parameter. The object can have a <code>fields</code> parameter, (an array) to let it know which fields you want to build explicitly</p><pre><code class="lang-js"><code class="source-code prettyprint">User.bulkCreate([
  { username: &apos;foo&apos; },
  { username: &apos;bar&apos;, admin: true}
], { fields: [&apos;username&apos;] }).then(function() {
  // nope bar, you can&apos;t be admin!
})</code>
</code></pre><p><code>bulkCreate</code> was originally made to be a mainstream/fast way of inserting records, however, sometimes you want the luxury of being able to insert multiple rows at once without sacrificing model validations even when you explicitly tell Sequelize which columns to sift through. You can do by adding a <code>validate: true</code> property to the options object.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Tasks = sequelize.define(&apos;task&apos;, {
  name: {
    type: Sequelize.STRING,
    validate: {
      notNull: { args: true, msg: &apos;name cannot be null&apos; }
    }
  },
  code: {
    type: Sequelize.STRING,
    validate: {
      len: [3, 10]
    }
  }
})

Tasks.bulkCreate([
  {name: &apos;foo&apos;, code: &apos;123&apos;},
  {code: &apos;1234&apos;},
  {name: &apos;bar&apos;, code: &apos;1&apos;}
], { validate: true }).catch(function(errors) {
  /* console.log(errors) would look like:
  [
    { record:
    ...
    errors:
      { name: &apos;SequelizeValidationError&apos;,
        message: &apos;Validation error&apos;,
        errors: [Object] } },
    { record:
      ...
      errors:
        { name: &apos;SequelizeValidationError&apos;,
        message: &apos;Validation error&apos;,
        errors: [Object] } }
  ]
  */
})</code>
</code></pre><h2>Values of an instance</h2><p>If you log an instance you will notice, that there is a lot of additional stuff. In order to hide such stuff and reduce it to the very interesting information, you can use the<code>get</code>-attribute. Calling it with the option <code>plain</code> = true will only return the values of an instance.</p><pre><code class="lang-js"><code class="source-code prettyprint">Person.create({
  name: &apos;Rambow&apos;,
  firstname: &apos;John&apos;
}).then(function(john) {
  console.log(john.get({
    plain: true
  }))
})

// result:

// { name: &apos;Rambow&apos;,
//   firstname: &apos;John&apos;,
//   id: 1,
//   createdAt: Tue, 01 May 2012 19:12:16 GMT,
//   updatedAt: Tue, 01 May 2012 19:12:16 GMT
// }</code>
</code></pre><p><strong>Hint:</strong>You can also transform an instance into JSON by using <code>JSON.stringify(instance)</code>. This will basically return the very same as <code>values</code>.</p><h2>Reloading instances</h2><p>If you need to get your instance in sync, you can use the method<code>reload</code>. It will fetch the current data from the database and overwrite the attributes of the model on which the method has been called on.</p><pre><code class="lang-js"><code class="source-code prettyprint">Person.findOne({ where: { name: &apos;john&apos; } }).then(function(person) {
  person.name = &apos;jane&apos;
  console.log(person.name) // &apos;jane&apos;

  person.reload().then(function() {
    console.log(person.name) // &apos;john&apos;
  })
})</code>
</code></pre><h2>Incrementing certain values of an instance</h2><p>In order to increment values of an instance without running into concurrency issues, you may use <code>increment</code>.</p><p>First of all you can define a field and the value you want to add to it.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findById(1).then(function(user) {
  return user.increment(&apos;my-integer-field&apos;, {by: 2})
}).then(/* ... */)</code>
</code></pre><p>Second, you can define multiple fields and the value you want to add to them.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findById(1).then(function(user) {
  return user.increment([ &apos;my-integer-field&apos;, &apos;my-very-other-field&apos; ], {by: 2})
}).then(/* ... */)</code>
</code></pre><p>Third, you can define an object containing fields and its increment values.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findById(1).then(function(user) {
  return user.increment({
    &apos;my-integer-field&apos;:    2,
    &apos;my-very-other-field&apos;: 3
  })
}).then(/* ... */)</code>
</code></pre><h2>Decrementing certain values of an instance</h2><p>In order to decrement values of an instance without running into concurrency issues, you may use <code>decrement</code>.</p><p>First of all you can define a field and the value you want to add to it.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findById(1).then(function(user) {
  return user.decrement(&apos;my-integer-field&apos;, {by: 2})
}).then(/* ... */)</code>
</code></pre><p>Second, you can define multiple fields and the value you want to add to them.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findById(1).then(function(user) {
  return user.decrement([ &apos;my-integer-field&apos;, &apos;my-very-other-field&apos; ], {by: 2})
}).then(/* ... */)</code>
</code></pre><p>Third, you can define an object containing fields and its decrement values.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.findById(1).then(function(user) {
  return user.decrement({
    &apos;my-integer-field&apos;:    2,
    &apos;my-very-other-field&apos;: 3
  })
}).then(/* ... */)</code>
</code></pre></div>
        <a data-ice="link" href="manual/tutorial/instances.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">Associations</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Associations</h1><p>This section describes the various association types in sequelize. When calling a method such as <code>User.hasOne(Project)</code>, we say that the <code>User</code> model (the model that the function is being invoked on) is the <strong>source</strong> and the <code>Project</code> model (the model being passed as an argument) is the <strong>target</strong>.</p><h2>One-To-One associations</h2><p>One-To-One associations are associations between exactly two models connected by a single foreign key.</p><h3>BelongsTo</h3><p>BelongsTo associations are associations where the foreign key for the one-to-one relation exists on the <strong>source model</strong>.</p><p>A simple example would be a <strong>Player</strong> being part of a <strong>Team</strong> with the foreign key on the player.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Player = this.sequelize.define(&apos;player&apos;, {/* attributes */})
  , Team  = this.sequelize.define(&apos;team&apos;, {/* attributes */});

Player.belongsTo(Team); // Will add a teamId attribute to Player to hold the primary key value for Team</code>
</code></pre><h4>Foreign keys</h4><p>By default the foreign key for a belongsTo relation will be generated from the target model name and the target primary key name.</p><p>The default casing is <code>camelCase</code> however if the source model is configured with <code>underscored: true</code> the foreignKey will be <code>snake_case</code>.</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = this.sequelize.define(&apos;user&apos;, {/* attributes */})
  , Company  = this.sequelize.define(&apos;company&apos;, {/* attributes */});

User.belongsTo(Company); // Will add companyId to user

var User = this.sequelize.define(&apos;user&apos;, {/* attributes */}, {underscored: true})
  , Company  = this.sequelize.define(&apos;company&apos;, {
    uuid: {
      type: Sequelize.UUID,
      primaryKey: true
    }
  });

User.belongsTo(Company); // Will add company_uuid to user</code>
</code></pre><p>In cases where <code>as</code> has been defined it will be used in place of the target model name.</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = this.sequelize.define(&apos;user&apos;, {/* attributes */})
  , UserRole  = this.sequelize.define(&apos;userRole&apos;, {/* attributes */});

User.belongsTo(UserRole, {as: &apos;role&apos;}); // Adds roleId to user rather than userRoleId</code>
</code></pre><p>In all cases the default foreign key can be overwritten with the <code>foreignKey</code> option.
When the foreign key option is used, Sequelize will use it as-is:</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = this.sequelize.define(&apos;user&apos;, {/* attributes */})
  , Company  = this.sequelize.define(&apos;company&apos;, {/* attributes */});

User.belongsTo(Company, {foreignKey: &apos;fk_company&apos;}); // Adds fk_company to User</code>
</code></pre><h4>Target keys</h4><p>The target key is the column on the target model that the foreign key column on the source model points to. By default the target key for a belongsTo relation will be the target model&apos;s primary key. To define a custom column, use the <code>targetKey</code> option.</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = this.sequelize.define(&apos;user&apos;, {/* attributes */})
  , Company  = this.sequelize.define(&apos;company&apos;, {/* attributes */});

User.belongsTo(Company, {foreignKey: &apos;fk_companyname&apos;, targetKey: &apos;name&apos;}); // Adds fk_companyname to User</code>
</code></pre><h3>HasOne</h3><p>HasOne associations are associations where the foreign key for the one-to-one relation exists on the <strong>target model</strong>.</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = sequelize.define(&apos;user&apos;, {/* ... */})
var Project = sequelize.define(&apos;project&apos;, {/* ... */})

// One-way associations
Project.hasOne(User)

/*
  In this example hasOne will add an attribute projectId to the User model!
  Furthermore, Project.prototype will gain the methods getUser and setUser according
  to the first parameter passed to define. If you have underscore style
  enabled, the added attribute will be project_id instead of projectId.

  The foreign key will be placed on the users table.

  You can also define the foreign key, e.g. if you already have an existing
  database and want to work on it:
*/

Project.hasOne(User, { foreignKey: &apos;initiator_id&apos; })

/*
  Because Sequelize will use the model&apos;s name (first parameter of define) for
  the accessor methods, it is also possible to pass a special option to hasOne:
*/

Project.hasOne(User, { as: &apos;Initiator&apos; })
// Now you will get Project#getInitiator and Project#setInitiator

// Or let&apos;s define some self references
var Person = sequelize.define(&apos;person&apos;, { /* ... */})

Person.hasOne(Person, {as: &apos;Father&apos;})
// this will add the attribute FatherId to Person

// also possible:
Person.hasOne(Person, {as: &apos;Father&apos;, foreignKey: &apos;DadId&apos;})
// this will add the attribute DadId to Person

// In both cases you will be able to do:
Person#setFather
Person#getFather

// If you need to join a table twice you can double join the same table
Team.hasOne(Game, {as: &apos;HomeTeam&apos;, foreignKey : &apos;homeTeamId&apos;});
Team.hasOne(Game, {as: &apos;AwayTeam&apos;, foreignKey : &apos;awayTeamId&apos;});

Game.belongsTo(Team);</code>
</code></pre><p>Even though it is called a HasOne association, for most 1:1 relations you usually want the BelongsTo association since BelongsTo will add the foreignKey on the source where hasOne will add on the target.</p><h3>Difference between HasOne and BelongsTo</h3><p>In Sequelize 1:1 relationship can be set using HasOne and BelongsTo. They are suitable for different scenarios. Lets study this difference using an example.</p><p>Suppose we have two tables to link <strong>Player</strong> and <strong>Team</strong>. Lets define their models.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Player = this.sequelize.define(&apos;player&apos;, {/* attributes */})
  , Team  = this.sequelize.define(&apos;team&apos;, {/* attributes */});</code>
</code></pre><p>When we link two models in Sequelize we can refer them as pairs of <strong>source</strong> and <strong>target</strong> models. Like this</p><p>Having <strong>Player</strong> as the <strong>source</strong> and <strong>Team</strong> as the <strong>target</strong></p><pre><code class="lang-js"><code class="source-code prettyprint">Player.belongsTo(Team);
//Or
Player.hasOne(Team);</code>
</code></pre><p>Having <strong>Team</strong> as the <strong>source</strong> and <strong>Player</strong> as the <strong>target</strong></p><pre><code class="lang-js"><code class="source-code prettyprint">Team.belongsTo(Player);
//Or
Team.hasOne(Player);</code>
</code></pre><p>HasOne and BelongsTo insert the association key in different models from each other. HasOne inserts the association key in <strong>target</strong> model whereas BelongsTo inserts the association key in the <strong>source</strong> model.</p><p>Here is an example demonstrating use cases of BelongsTo and HasOne.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Player = this.sequelize.define(&apos;player&apos;, {/* attributes */})
  , Coach  = this.sequelize.define(&apos;coach&apos;, {/* attributes */})
  , Team  = this.sequelize.define(&apos;team&apos;, {/* attributes */});</code>
</code></pre><p>Suppose our <code>Player</code> model has information about its team as <code>teamId</code> column. Information about each Team&apos;s <code>Coach</code> is stored in the <code>Team</code> model as <code>coachId</code> column. These both scenarios requires different kind of 1:1 relation because foreign key relation is present on different models each time.</p><p>When information about association is present in <strong>source</strong> model we can use <code>belongsTo</code>. In this case <code>Player</code> is suitable for <code>belongsTo</code> because it has <code>teamId</code> column.</p><pre><code class="lang-js"><code class="source-code prettyprint">Player.belongsTo(Team)  // `teamId` will be added on Player / Source model</code>
</code></pre><p>When information about association is present in <strong>target</strong> model we can use <code>hasOne</code>. In this case <code>Coach</code> is suitable for <code>hasOne</code> because <code>Team</code> model store information about its <code>Coach</code> as <code>coachId</code> field.</p><pre><code class="lang-js"><code class="source-code prettyprint">Coach.hasOne(Team)  // `coachId` will be added on Team / Target model</code>
</code></pre><h2>One-To-Many associations</h2><p>One-To-Many associations are connecting one source with multiple targets. The targets however are again connected to exactly one specific source.</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = sequelize.define(&apos;user&apos;, {/* ... */})
var Project = sequelize.define(&apos;project&apos;, {/* ... */})

// OK. Now things get more complicated (not really visible to the user :)).
// First let&apos;s define a hasMany association
Project.hasMany(User, {as: &apos;Workers&apos;})</code>
</code></pre><p>This will add the attribute <code>projectId</code> or <code>project_id</code> to User. Instances of Project will get the accessors <code>getWorkers</code> and <code>setWorkers</code>. We could just leave it the way it is and let it be a one-way association.
But we want more! Let&apos;s define it the other way around by creating a many to many association in the next section:</p><p>Sometimes you may need to associate records on different columns, you may use <code>sourceKey</code> option:</p><pre><code class="lang-js"><code class="source-code prettyprint">var City = sequelize.define(&apos;city&apos;, { countryCode: Sequelize.STRING });
var Country = sequelize.define(&apos;country&apos;, { isoCode: Sequelize.STRING });

// Here we can connect countries and cities base on country code
Country.hasMany(City, {foreignKey: &apos;countryCode&apos;, sourceKey: &apos;isoCode&apos;});
City.belongsTo(Country, {foreignKey: &apos;countryCode&apos;, targetKey: &apos;isoCode&apos;});</code>
</code></pre><h2>Belongs-To-Many associations</h2><p>Belongs-To-Many associations are used to connect sources with multiple targets. Furthermore the targets can also have connections to multiple sources.</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.belongsToMany(User, {through: &apos;UserProject&apos;});
User.belongsToMany(Project, {through: &apos;UserProject&apos;});</code>
</code></pre><p>This will create a new model called UserProject with the equivalent foreign keys <code>projectId</code> and <code>userId</code>. Whether the attributes are camelcase or not depends on the two models joined by the table (in this case User and Project).</p><p>Defining <code>through</code> is <strong>required</strong>. Sequelize would previously attempt to autogenerate names but that would not always lead to the most logical setups.</p><p>This will add methods <code>getUsers</code>, <code>setUsers</code>, <code>addUser</code>,<code>addUsers</code> to <code>Project</code>, and <code>getProjects</code>, <code>setProjects</code>, <code>addProject</code>, and <code>addProjects</code> to <code>User</code>.</p><p>Sometimes you may want to rename your models when using them in associations. Let&apos;s define users as workers and projects as tasks by using the alias (<code>as</code>) option. We will also manually define the foreign keys to use:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.belongsToMany(Project, { as: &apos;Tasks&apos;, through: &apos;worker_tasks&apos;, foreignKey: &apos;userId&apos; })
Project.belongsToMany(User, { as: &apos;Workers&apos;, through: &apos;worker_tasks&apos;, foreignKey: &apos;projectId&apos; })</code>
</code></pre><p><code>foreignKey</code> will allow you to set <strong>source model</strong> key in the <strong>through</strong> relation.
<code>otherKey</code> will allow you to set <strong>target model</strong> key in the <strong>through</strong> relation.</p><pre><code class="lang-js"><code class="source-code prettyprint">User.belongsToMany(Project, { as: &apos;Tasks&apos;, through: &apos;worker_tasks&apos;, foreignKey: &apos;userId&apos;, otherKey: &apos;projectId&apos;})</code>
</code></pre><p>Of course you can also define self references with belongsToMany:</p><pre><code class="lang-js"><code class="source-code prettyprint">Person.belongsToMany(Person, { as: &apos;Children&apos;, through: &apos;PersonChildren&apos; })
// This will create the table PersonChildren which stores the ids of the objects.</code>
</code></pre><p>If you want additional attributes in your join table, you can define a model for the join table in sequelize, before you define the association, and then tell sequelize that it should use that model for joining, instead of creating a new one:</p><pre><code class="lang-js"><code class="source-code prettyprint">User = sequelize.define(&apos;user&apos;, {})
Project = sequelize.define(&apos;project&apos;, {})
UserProjects = sequelize.define(&apos;userProjects&apos;, {
    status: DataTypes.STRING
})

User.belongsToMany(Project, { through: UserProjects })
Project.belongsToMany(User, { through: UserProjects })</code>
</code></pre><p>To add a new project to a user and set its status, you pass extra <code>options.through</code> to the setter, which contains the attributes for the join table</p><pre><code class="lang-js"><code class="source-code prettyprint">user.addProject(project, { through: { status: &apos;started&apos; }})</code>
</code></pre><p>By default the code above will add projectId and userId to the UserProjects table, and <em>remove any previously defined primary key attribute</em> - the table will be uniquely identified by the combination of the keys of the two tables, and there is no reason to have other PK columns. To enforce a primary key on the <code>UserProjects</code> model you can add it manually.</p><pre><code class="lang-js"><code class="source-code prettyprint">UserProjects = sequelize.define(&apos;userProjects&apos;, {
  id: {
    type: Sequelize.INTEGER,
    primaryKey: true,
    autoIncrement: true
  },
  status: DataTypes.STRING
})</code>
</code></pre><p>With Belongs-To-Many you can query based on <strong>through</strong> relation and select specific attributes. For example using <code>findAll</code> with <strong>through</strong></p><pre><code class="lang-js"><code class="source-code prettyprint">User.findAll({
  include: [{
    model: Project,
    through: {
      attributes: [&apos;createdAt&apos;, &apos;startedAt&apos;, &apos;finishedAt&apos;],
      where: {completed: true}
    }
  }]
});</code>
</code></pre><h2>Scopes</h2><p>This section concerns association scopes. For a definition of association scopes vs. scopes on associated models, see <a href="./manual/scopes">Scopes</a>.</p><p>Association scopes allow you to place a scope (a set of default attributes for <code>get</code> and <code>create</code>) on the association. Scopes can be placed both on the associated model (the target of the association), and on the through table for n:m relations.</p><h4>1:m</h4><p>Assume we have tables Comment, Post, and Image. A comment can be associated to either an image or a post via <code>commentable_id</code> and <code>commentable</code> - we say that Post and Image are <code>Commentable</code></p><pre><code class="lang-js"><code class="source-code prettyprint">this.Comment = this.sequelize.define(&apos;comment&apos;, {
  title: Sequelize.STRING,
  commentable: Sequelize.STRING,
  commentable_id: Sequelize.INTEGER
});

this.Comment.prototype.getItem = function() {
  return this[&apos;get&apos; + this.get(&apos;commentable&apos;).substr(0, 1).toUpperCase() + this.get(&apos;commentable&apos;).substr(1)]();
};

this.Post.hasMany(this.Comment, {
  foreignKey: &apos;commentable_id&apos;,
  constraints: false,
  scope: {
    commentable: &apos;post&apos;
  }
});
this.Comment.belongsTo(this.Post, {
  foreignKey: &apos;commentable_id&apos;,
  constraints: false,
  as: &apos;post&apos;
});

this.Image.hasMany(this.Comment, {
  foreignKey: &apos;commentable_id&apos;,
  constraints: false,
  scope: {
    commentable: &apos;image&apos;
  }
});
this.Comment.belongsTo(this.Image, {
  foreignKey: &apos;commentable_id&apos;,
  constraints: false,
  as: &apos;image&apos;
});</code>
</code></pre><p><code>constraints: false,</code> disables references constraints - since the <code>commentable_id</code> column references several tables, we cannot add a <code>REFERENCES</code> constraint to it. Note that the Image -&gt; Comment and Post -&gt; Comment relations define a scope, <code>commentable: &apos;image&apos;</code> and <code>commentable: &apos;post&apos;</code> respectively. This scope is automatically applied when using the association functions:</p><pre><code class="lang-js"><code class="source-code prettyprint">image.getComments()
SELECT * FROM comments WHERE commentable_id = 42 AND commentable = &apos;image&apos;;

image.createComment({
  title: &apos;Awesome!&apos;
})
INSERT INTO comments (title, commentable_id, commentable) VALUES (&apos;Awesome!&apos;, 42, &apos;image&apos;);

image.addComment(comment);
UPDATE comments SET commentable_id = 42, commentable = &apos;image&apos;</code>
</code></pre><p>The <code>getItem</code> utility function on <code>Comment</code> completes the picture - it simply converts the <code>commentable</code> string into a call to either <code>getImage</code> or <code>getPost</code>, providing an abstraction over whether a comment belongs to a post or an image.</p><h4>n:m</h4><p>Continuing with the idea of a polymorphic model, consider a tag table - an item can have multiple tags, and a tag can be related to several items.</p><p>For brevity, the example only shows a Post model, but in reality Tag would be related to several other models.</p><pre><code class="lang-js"><code class="source-code prettyprint">ItemTag = sequelize.define(&apos;item_tag&apos;, {
  id : {
    type: DataTypes.INTEGER,
    primaryKey: true,
    autoIncrement: true
  },
  tag_id: {
    type: DataTypes.INTEGER,
    unique: &apos;item_tag_taggable&apos;
  },
  taggable: {
    type: DataTypes.STRING,
    unique: &apos;item_tag_taggable&apos;
  },
  taggable_id: {
    type: DataTypes.INTEGER,
    unique: &apos;item_tag_taggable&apos;,
    references: null
  }
});
Tag = sequelize.define(&apos;tag&apos;, {
  name: DataTypes.STRING
});

Post.belongsToMany(Tag, {
  through: {
    model: ItemTag,
    unique: false,
    scope: {
      taggable: &apos;post&apos;
    }
  },
  foreignKey: &apos;taggable_id&apos;,
  constraints: false
});
Tag.belongsToMany(Post, {
  through: {
    model: ItemTag,
    unique: false
  },
  foreignKey: &apos;tag_id&apos;,
  constraints: false
});</code>
</code></pre><p>Notice that the scoped column (<code>taggable</code>) is now on the through model (<code>ItemTag</code>).</p><p>We could also define a more restrictive association, for example, to get all pending tags for a post by applying a scope of both the through model (<code>ItemTag</code>) and the target model (<code>Tag</code>):</p><pre><code class="lang-js"><code class="source-code prettyprint">Post.hasMany(Tag, {
  through: {
    model: ItemTag,
    unique: false,
    scope: {
      taggable: &apos;post&apos;
    }
  },
  scope: {
    status: &apos;pending&apos;
  },
  as: &apos;pendingTags&apos;,
  foreignKey: &apos;taggable_id&apos;,
  constraints: false
});

Post.getPendingTags();</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT `tag`.*  INNER JOIN `item_tags` AS `item_tag`
ON `tag`.`id` = `item_tag`.`tagId`
  AND `item_tag`.`taggable_id` = 42
  AND `item_tag`.`taggable` = &apos;post&apos;
WHERE (`tag`.`status` = &apos;pending&apos;);</code>
</code></pre><p><code>constraints: false</code> disables references constraints on the <code>taggable_id</code> column. Because the column is polymorphic, we cannot say that it <code>REFERENCES</code> a specific table.</p><h2>Naming strategy</h2><p>By default sequelize will use the model name (the name passed to <code>sequelize.define</code>) to figure out the name of the model when used in associations. For example, a model named <code>user</code> will add the functions <code>get/set/add User</code> to instances of the associated model, and a property named <code>.user</code> in eager loading, while a model named <code>User</code> will add the same functions, but a property named <code>.User</code> (notice the upper case U) in eager loading.</p><p>As we&apos;ve already seen, you can alias models in associations using <code>as</code>. In single associations (has one and belongs to), the alias should be singular, while for many associations (has many) it should be plural. Sequelize then uses the <a href="https://www.npmjs.org/package/inflection">inflection </a>library to convert the alias to its singular form. However, this might not always work for irregular or non-english words. In this case, you can provide both the plural and the singular form of the alias:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.belongsToMany(Project, { as: { singular: &apos;task&apos;, plural: &apos;tasks&apos; }})
// Notice that inflection has no problem singularizing tasks, this is just for illustrative purposes.</code>
</code></pre><p>If you know that a model will always use the same alias in associations, you can provide it when creating the model</p><pre><code class="lang-js"><code class="source-code prettyprint">var Project = sequelize.define(&apos;project&apos;, attributes, {
  name: {
    singular: &apos;task&apos;,
    plural: &apos;tasks&apos;,
  }
})

User.belongsToMany(Project);</code>
</code></pre><p>This will add the functions <code>add/set/get Tasks</code> to user instances.</p><p>Remember, that using <code>as</code> to change the name of the association will also change the name of the foreign key. When using <code>as</code>, it is safest to also specify the foreign key.</p><pre><code class="lang-js"><code class="source-code prettyprint">Invoice.belongsTo(Subscription)
Subscription.hasMany(Invoice)</code>
</code></pre><p>Without <code>as</code>, this adds <code>subscriptionId</code> as expected. However, if you were to say <code>Invoice.belongsTo(Subscription, { as: &apos;TheSubscription&apos; })</code>, you will have both <code>subscriptionId</code> and <code>theSubscriptionId</code>, because sequelize is not smart enough to figure that the calls are two sides of the same relation. &apos;foreignKey&apos; fixes this problem;</p><pre><code class="lang-js"><code class="source-code prettyprint">Invoice.belongsTo(Subscription, , { as: &apos;TheSubscription&apos;, foreignKey: &apos;subscription_id&apos; })
Subscription.hasMany(Invoice, { foreignKey: &apos;subscription_id&apos; )</code>
</code></pre><h2>Associating objects</h2><p>Because Sequelize is doing a lot of magic, you have to call <code>Sequelize.sync</code> after setting the associations! Doing so will allow you the following:</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.belongsToMany(Task)
Task.belongsToMany(Project)

Project.create()...
Task.create()...
Task.create()...

// save them... and then:
project.setTasks([task1, task2]).then(function() {
  // saved!
})

// ok, now they are saved... how do I get them later on?
project.getTasks().then(function(associatedTasks) {
  // associatedTasks is an array of tasks
})

// You can also pass filters to the getter method.
// They are equal to the options you can pass to a usual finder method.
project.getTasks({ where: &apos;id &gt; 10&apos; }).then(function(tasks) {
  // tasks with an id greater than 10 :)
})

// You can also only retrieve certain fields of a associated object.
project.getTasks({attributes: [&apos;title&apos;]}).then(function(tasks) {
    // retrieve tasks with the attributes &quot;title&quot; and &quot;id&quot;
})</code>
</code></pre><p>To remove created associations you can just call the set method without a specific id:</p><pre><code class="lang-js"><code class="source-code prettyprint">// remove the association with task1
project.setTasks([task2]).then(function(associatedTasks) {
  // you will get task2 only
})

// remove &apos;em all
project.setTasks([]).then(function(associatedTasks) {
  // you will get an empty array
})

// or remove &apos;em more directly
project.removeTask(task1).then(function() {
  // it&apos;s gone
})

// and add &apos;em again
project.addTask(task1).then(function() {
  // it&apos;s back again
})</code>
</code></pre><p>You can of course also do it vice versa:</p><pre><code class="lang-js"><code class="source-code prettyprint">// project is associated with task1 and task2
task2.setProject(null).then(function() {
  // and it&apos;s gone
})</code>
</code></pre><p>For hasOne/belongsTo its basically the same:</p><pre><code class="lang-js"><code class="source-code prettyprint">Task.hasOne(User, {as: &quot;Author&quot;})
Task#setAuthor(anAuthor)</code>
</code></pre><p>Adding associations to a relation with a custom join table can be done in two ways (continuing with the associations defined in the previous chapter):</p><pre><code class="lang-js"><code class="source-code prettyprint">// Either by adding a property with the name of the join table model to the object, before creating the association
project.UserProjects = {
  status: &apos;active&apos;
}
u.addProject(project)

// Or by providing a second options.through argument when adding the association, containing the data that should go in the join table
u.addProject(project, { through: { status: &apos;active&apos; }})


// When associating multiple objects, you can combine the two options above. In this case the second argument
// will be treated as a defaults object, that will be used if no data is provided
project1.UserProjects = {
    status: &apos;inactive&apos;
}

u.setProjects([project1, project2], { through: { status: &apos;active&apos; }})
// The code above will record inactive for project one, and active for project two in the join table</code>
</code></pre><p>When getting data on an association that has a custom join table, the data from the join table will be returned as a DAO instance:</p><pre><code class="lang-js"><code class="source-code prettyprint">u.getProjects().then(function(projects) {
  var project = projects[0]

  if (project.UserProjects.status === &apos;active&apos;) {
    // .. do magic

    // since this is a real DAO instance, you can save it directly after you are done doing magic
    return project.UserProjects.save()
  }
})</code>
</code></pre><p>If you only need some of the attributes from the join table, you can provide an array with the attributes you want:</p><pre><code class="lang-js"><code class="source-code prettyprint">// This will select only name from the Projects table, and only status from the UserProjects table
user.getProjects({ attributes: [&apos;name&apos;], joinTableAttributes: [&apos;status&apos;]})</code>
</code></pre><h2>Check associations</h2><p>You can also check if an object is already associated with another one (N:M only). Here is how you&apos;d do it:</p><pre><code class="lang-js"><code class="source-code prettyprint">// check if an object is one of associated ones:
Project.create({ /* */ }).then(function(project) {
  return User.create({ /* */ }).then(function(user) {
    return project.hasUser(user).then(function(result) {
      // result would be false
      return project.addUser(user).then(function() {
        return project.hasUser(user).then(function(result) {
          // result would be true
        })
      })
    })
  })
})

// check if all associated objects are as expected:
// let&apos;s assume we have already a project and two users
project.setUsers([user1, user2]).then(function() {
  return project.hasUsers([user1]);
}).then(function(result) {
  // result would be false
  return project.hasUsers([user1, user2]);
}).then(function(result) {
  // result would be true
})</code>
</code></pre><h2>Foreign Keys</h2><p>When you create associations between your models in sequelize, foreign key references with constraints will automatically be created. The setup below:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Task = this.sequelize.define(&apos;task&apos;, { title: Sequelize.STRING })
  , User = this.sequelize.define(&apos;user&apos;, { username: Sequelize.STRING })

User.hasMany(Task)
Task.belongsTo(User)</code>
</code></pre><p>Will generate the following SQL:</p><pre><code class="lang-sql"><code class="source-code prettyprint">CREATE TABLE IF NOT EXISTS `User` (
  `id` INTEGER PRIMARY KEY,
  `username` VARCHAR(255)
);

CREATE TABLE IF NOT EXISTS `Task` (
  `id` INTEGER PRIMARY KEY,
  `title` VARCHAR(255),
  `user_id` INTEGER REFERENCES `User` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
);</code>
</code></pre><p>The relation between task and user injects the <code>user_id</code> foreign key on tasks, and marks it as a reference to the <code>User</code> table. By default <code>user_id</code> will be set to <code>NULL</code> if the referenced user is deleted, and updated if the id of the user id updated. These options can be overridden by passing <code>onUpdate</code> and <code>onDelete</code> options to the association calls. The validation options are <code>RESTRICT, CASCADE, NO ACTION, SET DEFAULT, SET NULL</code>.</p><p>For 1:1 and 1:m associations the default option is <code>SET NULL</code> for deletion, and <code>CASCADE</code> for updates. For n:m, the default for both is <code>CASCADE</code>. This means, that if you delete or update a row from one side of an n:m association, all the rows in the join table referencing that row will also be deleted or updated.</p><p>Adding constraints between tables means that tables must be created in the database in a certain order, when using <code>sequelize.sync</code>. If Task has a reference to User, the User table must be created before the Task table can be created. This can sometimes lead to circular references, where sequelize cannot find an order in which to sync. Imagine a scenario of documents and versions. A document can have multiple versions, and for convenience, a document has an reference to it&apos;s current version.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Document = this.sequelize.define(&apos;document&apos;, {
      author: Sequelize.STRING
    })
  , Version = this.sequelize.define(&apos;version&apos;, {
      timestamp: Sequelize.DATE
    })

Document.hasMany(Version) // This adds document_id to version
Document.belongsTo(Version, { as: &apos;Current&apos;, foreignKey: &apos;current_version_id&apos;}) // This adds current_version_id to document</code>
</code></pre><p>However, the code above will result in the following error: <code>Cyclic dependency found. &apos;Document&apos; is dependent of itself. Dependency Chain: Document -&gt; Version =&gt; Document</code>. In order to alleviate that, we can pass <code>constraints: false</code> to one of the associations:</p><pre><code class="lang-js"><code class="source-code prettyprint">Document.hasMany(Version)
Document.belongsTo(Version, { as: &apos;Current&apos;, foreignKey: &apos;current_version_id&apos;, constraints: false})</code>
</code></pre><p>Which will allow us to sync the tables correctly:</p><pre><code class="lang-sql"><code class="source-code prettyprint">CREATE TABLE IF NOT EXISTS `Document` (
  `id` INTEGER PRIMARY KEY,
  `author` VARCHAR(255),
  `current_version_id` INTEGER
);
CREATE TABLE IF NOT EXISTS `Version` (
  `id` INTEGER PRIMARY KEY,
  `timestamp` DATETIME,
  `document_id` INTEGER REFERENCES `Document` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
);</code>
</code></pre><h3>Enforcing a foreign key reference without constraints</h3><p>Sometimes you may want to reference another table, without adding any constraints, or associations. In that case you can manually add the reference attributes to your schema definition, and mark the relations between them.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Series, Trainer, Video

// Series has a trainer_id=Trainer.id foreign reference key after we call Trainer.hasMany(series)
Series = sequelize.define(&apos;series&apos;, {
  title:        DataTypes.STRING,
  sub_title:    DataTypes.STRING,
  description:  DataTypes.TEXT,

  // Set FK relationship (hasMany) with `Trainer`
  trainer_id: {
    type: DataTypes.INTEGER,
    references: {
      model: &quot;trainers&quot;,
      key: &quot;id&quot;
    }
  }
})

Trainer = sequelize.define(&apos;trainer&apos;, {
  first_name: DataTypes.STRING,
  last_name:  DataTypes.STRING
});

// Video has a series_id=Series.id foreign reference key after we call Series.hasOne(Video)...
Video = sequelize.define(&apos;video&apos;, {
  title:        DataTypes.STRING,
  sequence:     DataTypes.INTEGER,
  description:  DataTypes.TEXT,

  // set relationship (hasOne) with `Series`
  series_id: {
    type: DataTypes.INTEGER,
    references: {
      model: Series, // Can be both a string representing the table name, or a reference to the model
      key:   &quot;id&quot;
    }
  }
});

Series.hasOne(Video);
Trainer.hasMany(Series);</code>
</code></pre><h2>Creating with associations</h2><p>An instance can be created with nested association in one step, provided all elements are new.</p><h3>Creating elements of a &quot;BelongsTo&quot;, &quot;Has Many&quot; or &quot;HasOne&quot; association</h3><p>Consider the following models:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Product = this.sequelize.define(&apos;product&apos;, {
  title: Sequelize.STRING
});
var User = this.sequelize.define(&apos;user&apos;, {
  first_name: Sequelize.STRING,
  last_name: Sequelize.STRING
});
var Address = this.sequelize.define(&apos;address&apos;, {
  type: Sequelize.STRING,
  line_1: Sequelize.STRING,
  line_2: Sequelize.STRING,
  city: Sequelize.STRING,
  state: Sequelize.STRING,
  zip: Sequelize.STRING,
});

var Product.User = Product.belongsTo(User);
var User.Addresses = User.hasMany(Address);
// Also works for `hasOne`</code>
</code></pre><p>A new <code>Product</code>, <code>User</code>, and one or more <code>Address</code> can be created in one step in the following way:</p><pre><code class="lang-js"><code class="source-code prettyprint">return Product.create({
  title: &apos;Chair&apos;,
  user: {
    first_name: &apos;Mick&apos;,
    last_name: &apos;Broadstone&apos;,
    addresses: [{
      type: &apos;home&apos;,
      line_1: &apos;100 Main St.&apos;,
      city: &apos;Austin&apos;,
      state: &apos;TX&apos;,
      zip: &apos;78704&apos;
    }]
  }
}, {
  include: [{
    association: Product.User,
    include: [ User.Addresses ]
  }]
});</code>
</code></pre><p>Here, our user model is called <code>user</code>, with a lowercase u - This means that the property in the object should also be <code>user</code>. If the name given to <code>sequelize.define</code> was <code>User</code>, the key in the object should also be <code>User</code>. Likewise for <code>addresses</code>, except it&apos;s pluralized being a <code>hasMany</code> association.</p><h3>Creating elements of a &quot;BelongsTo&quot; association with an alias</h3><p>The previous example can be extended to support an association alias.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Creator = Product.belongsTo(User, {as: &apos;creator&apos;});

return Product.create({
  title: &apos;Chair&apos;,
  creator: {
    first_name: &apos;Matt&apos;,
    last_name: &apos;Hansen&apos;
  }
}, {
  include: [ Creator ]
});</code>
</code></pre><h3>Creating elements of a &quot;HasMany&quot; or &quot;BelongsToMany&quot; association</h3><p>Let&apos;s introduce the ability to associate a project with many tags. Setting up the models could look like:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Tag = this.sequelize.define(&apos;tag&apos;, {
  name: Sequelize.STRING
});

Product.hasMany(Tag);
// Also works for `belongsToMany`.</code>
</code></pre><p>Now we can create a project with multiple tags in the following way:</p><pre><code class="lang-js"><code class="source-code prettyprint">Product.create({
  id: 1,
  title: &apos;Chair&apos;,
  tags: [
    { name: &apos;Alpha&apos;},
    { name: &apos;Beta&apos;}
  ]
}, {
  include: [ Tag ]
})</code>
</code></pre><p>And, we can modify this example to support an alias as well:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Categories = Product.hasMany(Tag, {as: &apos;categories&apos;});

Product.create({
  id: 1,
  title: &apos;Chair&apos;,
  categories: [
    {id: 1, name: &apos;Alpha&apos;},
    {id: 2, name: &apos;Beta&apos;}
  ]
}, {
  include: [{
    model: Categories,
    as: &apos;categories&apos;
  }]
})</code>
</code></pre><hr></div>
        <a data-ice="link" href="manual/tutorial/associations.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">Transactions</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Transactions</h1><p>Sequelize supports two ways of using transactions:</p><ul>
<li>One which will automatically commit or rollback the transaction based on the result of a promise chain and, (if enabled) pass the transaction to all calls within the callback</li>
<li>And one which leaves committing, rolling back and passing the transaction to the user.</li>
</ul><p>The key difference is that the managed transaction uses a callback that expects a promise to be returned to it while the unmanaged transaction returns a promise.</p><h2>Managed transaction (auto-callback)</h2><p>Managed transactions handle committing or rolling back the transaction automagically. You start a managed transaction by passing a callback to <code>sequelize.transaction</code>.</p><p>Notice how the callback passed to <code>transaction</code> returns a promise chain, and does not explicitly call <code>t.commit()</code> nor <code>t.rollback()</code>. If all promises in the returned chain are resolved successfully the transaction is committed. If one or several of the promises are rejected, the transaction is rolled back.</p><pre><code class="lang-js"><code class="source-code prettyprint">return sequelize.transaction(function (t) {

  // chain all your queries here. make sure you return them.
  return User.create({
    firstName: &apos;Abraham&apos;,
    lastName: &apos;Lincoln&apos;
  }, {transaction: t}).then(function (user) {
    return user.setShooter({
      firstName: &apos;John&apos;,
      lastName: &apos;Boothe&apos;
    }, {transaction: t});
  });

}).then(function (result) {
  // Transaction has been committed
  // result is whatever the result of the promise chain returned to the transaction callback
}).catch(function (err) {
  // Transaction has been rolled back
  // err is whatever rejected the promise chain returned to the transaction callback
});</code>
</code></pre><h3>Throw errors to rollback</h3><p>When using the managed transaction you should <em>never</em> commit or rollback the transaction manually. If all queries are successful, but you still want to rollback the transaction (for example because of a validation failure) you should throw an error to break and reject the chain:</p><pre><code class="lang-js"><code class="source-code prettyprint">return sequelize.transaction(function (t) {
  return User.create({
    firstName: &apos;Abraham&apos;,
    lastName: &apos;Lincoln&apos;
  }, {transaction: t}).then(function (user) {
    // Woops, the query was successful but we still want to roll back!
    throw new Error();
  });
});</code>
</code></pre><h3>Automatically pass transactions to all queries</h3><p>In the examples above, the transaction is still manually passed, by passing <code>{ transaction: t }</code> as the second argument. To automatically pass the transaction to all queries you must install the <a href="https://github.com/othiym23/node-continuation-local-storage">continuation local storage</a> (CLS) module and instantiate a namespace in your own code:</p><pre><code class="lang-js"><code class="source-code prettyprint">var cls = require(&apos;continuation-local-storage&apos;),
    namespace = cls.createNamespace(&apos;my-very-own-namespace&apos;);</code>
</code></pre><p>To enable CLS you must tell sequelize which namespace to use by using a static method of the sequelize constructor:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Sequelize = require(&apos;sequelize&apos;);
Sequelize.useCLS(namespace);

new Sequelize(....);</code>
</code></pre><p>Notice, that the <code>useCLS()</code> method is on the <em>constructor</em>, not on an instance of sequelize. This means that all instances will share the same namespace, and that CLS is all-or-nothing - you cannot enable it only for some instances.</p><p>CLS works like a thread-local storage for callbacks. What this means in practice is that different callback chains can access local variables by using the CLS namespace. When CLS is enabled sequelize will set the <code>transaction</code> property on the namespace when a new transaction is created. Since variables set within a callback chain are private to that chain several concurrent transactions can exist at the same time:</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.transaction(function (t1) {
  namespace.get(&apos;transaction&apos;) === t1; // true
});

sequelize.transaction(function (t2) {
  namespace.get(&apos;transaction&apos;) === t2; // true
});</code>
</code></pre><p>In most case you won&apos;t need to access <code>namespace.get(&apos;transaction&apos;)</code> directly, since all queries will automatically look for a transaction on the namespace:</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.transaction(function (t1) {
  // With CLS enabled, the user will be created inside the transaction
  return User.create({ name: &apos;Alice&apos; });
});</code>
</code></pre><p>After you&apos;ve used <code>Sequelize.useCLS()</code> all promises returned from sequelize will be patched to maintain CLS context. CLS is a complicated subject - more details in the docs for <a href="https://www.npmjs.com/package/cls-bluebird">cls-bluebird</a>, the patch used to make bluebird promises work with CLS.</p><h2>Concurrent/Partial transactions</h2><p>You can have concurrent transactions within a sequence of queries or have some of them excluded from any transactions. Use the <code>{transaction: }</code> option to control which transaction a query belong to:</p><h3>Without CLS enabled</h3><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.transaction(function (t1) {
  return sequelize.transaction(function (t2) {
    // With CLS enable, queries here will by default use t2
    // Pass in the `transaction` option to define/alter the transaction they belong to.
    return Promise.all([
        User.create({ name: &apos;Bob&apos; }, { transaction: null }),
        User.create({ name: &apos;Mallory&apos; }, { transaction: t1 }),
        User.create({ name: &apos;John&apos; }) // this would default to t2
    ]);
  });
});</code>
</code></pre><h2>Isolation levels</h2><p>The possible isolations levels to use when starting a transaction:</p><pre><code class="lang-js"><code class="source-code prettyprint">Sequelize.Transaction.ISOLATION_LEVELS.READ_UNCOMMITTED // &quot;READ UNCOMMITTED&quot;
Sequelize.Transaction.ISOLATION_LEVELS.READ_COMMITTED // &quot;READ COMMITTED&quot;
Sequelize.Transaction.ISOLATION_LEVELS.REPEATABLE_READ  // &quot;REPEATABLE READ&quot;
Sequelize.Transaction.ISOLATION_LEVELS.SERIALIZABLE // &quot;SERIALIZABLE&quot;</code>
</code></pre><p>By default, sequelize uses &quot;REPEATABLE READ&quot;. If you want to use a different isolation level, pass in the desired level as the first argument:</p><pre><code class="lang-js"><code class="source-code prettyprint">return sequelize.transaction({
  isolationLevel: Sequelize.Transaction.ISOLATION_LEVELS.SERIALIZABLE
  }, function (t) {

  // your transactions

  });</code>
</code></pre><p>Note: The SET ISOLATION LEVEL queries are not logged in case of MSSQL as the specified isolationLevel is passed directly to tedious</p><h2>Unmanaged transaction (then-callback)</h2><p>Unmanaged transactions force you to manually rollback or commit the transaction. If you don&apos;t do that, the transaction will hang until it times out. To start an unmanaged transaction, call <code>sequelize.transaction()</code> without a callback (you can still pass an options object) and call <code>then</code> on the returned promise. Notice that <code>commit()</code> and <code>rollback()</code> returns a promise.</p><pre><code class="lang-js"><code class="source-code prettyprint">return sequelize.transaction().then(function (t) {
  return User.create({
    firstName: &apos;Homer&apos;,
    lastName: &apos;Simpson&apos;
  }, {transaction: t}).then(function (user) {
    return user.addSibling({
      firstName: &apos;Lisa&apos;,
      lastName: &apos;Simpson&apos;
    }, {transaction: t});
  }).then(function () {
    return t.commit();
  }).catch(function (err) {
    return t.rollback();
  });
});</code>
</code></pre><h2>Options</h2><p>The <code>transaction</code> method can be called with an options object as the first argument, that
allows the configuration of the transaction.</p><pre><code class="lang-js"><code class="source-code prettyprint">return sequelize.transaction({ /* options */ });</code>
</code></pre><p>The following options (with it&apos;s default values) are available:</p><pre><code class="lang-js"><code class="source-code prettyprint">{
  autocommit: true,
  isolationLevel: &apos;REPEATABLE_READ&apos;,
  deferrable: &apos;NOT DEFERRABLE&apos; // implicit default of postgres
}</code>
</code></pre><p>The <code>isolationLevel</code> can either be set globally when initializing the Sequelize instance or
locally for every transaction:</p><pre><code class="lang-js"><code class="source-code prettyprint">// globally
new Sequelize(&apos;db&apos;, &apos;user&apos;, &apos;pw&apos;, {
  isolationLevel: Sequelize.Transaction.ISOLATION_LEVELS.SERIALIZABLE
});

// locally
sequelize.transaction({
  isolationLevel: Sequelize.Transaction.ISOLATION_LEVELS.SERIALIZABLE
});</code>
</code></pre><p>The <code>deferrable</code> option triggers an additional query after the transaction start
that optionally set the constraint checks to be deferred or immediate. Please note
that this is only supported in PostgreSQL.</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.transaction({
  // to defer all constraints:
  deferrable: Sequelize.Deferrable.SET_DEFERRED,

  // to defer a specific constraint:
  deferrable: Sequelize.Deferrable.SET_DEFERRED([&apos;some_constraint&apos;]),

  // to not defer constraints:
  deferrable: Sequelize.Deferrable.SET_IMMEDIATE
})</code>
</code></pre><h2>Usage with other sequelize methods</h2><p>The <code>transaction</code> option goes with most other options, which are usually the first argument of a method.
For methods that take values, like <code>.create</code>, <code>.update()</code>, <code>.updateAttributes()</code> etc. <code>transaction</code> should be passed to the option in the second argument.
If unsure, refer to the API documentation for the method you are using to be sure of the signature.</p></div>
        <a data-ice="link" href="manual/tutorial/transactions.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;"><span data-ice="label-inner">Scopes</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Scopes</h1><p>Scoping allows you to define commonly used queries that you can easily use later. Scopes can include all the same attributes as regular finders, <code>where</code>, <code>include</code>, <code>limit</code> etc.</p><h2>Definition</h2><p>Scopes are defined in the model definition and can be finder objects, or functions returning finder objects - except for the default scope, which can only be an object:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Project = sequelize.define(&apos;project&apos;, {
  // Attributes
}, {
  defaultScope: {
    where: {
      active: true
    }
  },
  scopes: {
    deleted: {
      where: {
        deleted: true
      }
    },
    activeUsers: {
      include: [
        { model: User, where: { active: true }}
      ]
    }
    random: function () {
      return {
        where: {
          someNumber: Math.random()
        }
      }
    },
    accessLevel: function (value) {
      return {
        where: {
          accessLevel: {
            $gte: value
          }
        }
      }
    }
  }
});</code>
</code></pre><p>You can also add scopes after a model has been defined by calling <code>addScope</code>. This is especially useful for scopes with includes, where the model in the include might not be defined at the time the other model is being defined.</p><p>The default scope is always applied. This means, that with the model definition above, <code>Project.findAll()</code> will create the following query:</p><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT * FROM projects WHERE active = true</code>
</code></pre><p>The default scope can be removed by calling <code>.unscoped()</code>, <code>.scope(null)</code>, or by invoking another scope:</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.scope(&apos;deleted&apos;).findAll(); // Removes the default scope</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT * FROM projects WHERE deleted = true</code>
</code></pre><p>It is also possible to include scoped models in a scope definition. This allows you to avoid duplicating <code>include</code>, <code>attributes</code> or <code>where</code> definitions.
Using the above example, and invoking the <code>active</code> scope on the included User model (rather than specifying the condition directly in that include object):</p><pre><code class="lang-js"><code class="source-code prettyprint">activeUsers: {
  include: [
    { model: User.scope(&apos;active&apos;)}
  ]
}</code>
</code></pre><h2>Usage</h2><p>Scopes are applied by calling <code>.scope</code> on the model definition, passing the name of one or more scopes. <code>.scope</code> returns a fully functional model instance with all the regular methods: <code>.findAll</code>, <code>.update</code>, <code>.count</code>, <code>.destroy</code> etc. You can save this model instance and reuse it later:</p><pre><code class="lang-js"><code class="source-code prettyprint">var DeletedProjects = Project.scope(&apos;deleted&apos;);

DeletedProjects.findAll();
// some time passes

// let&apos;s look for deleted projects again!
DeletedProjects.findAll();</code>
</code></pre><p>Scopes apply to <code>.find</code>, <code>.findAll</code>, <code>.count</code>, <code>.update</code> and <code>.destroy</code>.</p><p>Scopes which are functions can be invoked in two ways. If the scope does not take any arguments it can be invoked as normally. If the scope takes arguments, pass an object:</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.scope(&apos;random&apos;, { method: [&apos;accessLevel&apos;, 19]}).findAll();</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT * FROM projects WHERE someNumber = 42 AND accessLevel &gt;= 19</code>
</code></pre><h2>Merging</h2><p>Several scopes can be applied simultaneously by passing an array of scopes to <code>.scope</code>, or by passing the scopes as consecutive arguments.</p><pre><code class="lang-js"><code class="source-code prettyprint">// These two are equivalent
Project.scope(&apos;deleted&apos;, &apos;activeUsers&apos;).findAll();
Project.scope([&apos;deleted&apos;, &apos;activeUsers&apos;]).findAll();</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT * FROM projects
INNER JOIN users ON projects.userId = users.id
AND users.active = true</code>
</code></pre><p>If you want to apply another scope alongside the default scope, pass the key <code>defaultScope</code> to <code>.scope</code>:</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.scope(&apos;defaultScope&apos;, &apos;deleted&apos;).findAll();</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">SELECT * FROM projects WHERE active = true AND deleted = true</code>
</code></pre><p>When invoking several scopes, keys from subsequent scopes will overwrite previous ones (similar to <a href="https://lodash.com/docs#assign">_.assign</a>). Consider two scopes:</p><pre><code class="lang-js"><code class="source-code prettyprint">{
  scope1: {
    where: {
      firstName: &apos;bob&apos;,
      age: {
        $gt: 20
      }
    },
    limit: 2
  },
  scope2: {
    where: {
      age: {
        $gt: 30
      }
    },
    limit: 10
  }
}</code>
</code></pre><p>Calling <code>.scope(&apos;scope1&apos;, &apos;scope2&apos;)</code> will yield the following query</p><pre><code class="lang-sql"><code class="source-code prettyprint">WHERE firstName = &apos;bob&apos; AND age &gt; 30 LIMIT 10</code>
</code></pre><p>Note how <code>limit</code> and <code>age</code> are overwritten by <code>scope2</code>, while <code>firstName</code> is preserved. <code>limit</code>, <code>offset</code>, <code>order</code>, <code>paranoid</code>, <code>lock</code> and <code>raw</code> are overwritten, while <code>where</code> and <code>include</code> are shallowly merged. This means that identical keys in the where objects, and subsequent includes of the same model will both overwrite each other.</p><p>The same merge logic applies when passing a find object directly to findAll on a scoped model:</p><pre><code class="lang-js"><code class="source-code prettyprint">Project.scope(&apos;deleted&apos;).findAll({
  where: {
    firstName: &apos;john&apos;
  }
})</code>
</code></pre><pre><code class="lang-sql"><code class="source-code prettyprint">WHERE deleted = true AND firstName = &apos;john&apos;</code>
</code></pre><p>Here the <code>deleted</code> scope is merged with the finder. If we were to pass <code>where: { firstName: &apos;john&apos;, deleted: false }</code> to the finder, the <code>deleted</code> scope would be overwritten.</p><h2>Associations</h2><p>Sequelize has two different but related scope concepts in relation to associations. The difference is subtle but important:</p><ul>
<li><strong>Association scopes</strong> Allow you to specify default attributes when getting and setting associations - useful when implementing polymorphic associations. This scope is only invoked on the association between the two models, when using the <code>get</code>, <code>set</code>, <code>add</code> and <code>create</code> associated model functions</li>
<li><strong>Scopes on associated models</strong> Allows you to apply default and other scopes when fetching associations, and allows you to pass a scoped model when creating associations. These scopes both apply to regular finds on the model and to find through the association.</li>
</ul><p>As an example, consider the models Post and Comment. Comment is associated to several other models (Image, Video etc.) and the association between Comment and other models is polymorphic, which means that Comment stores a <code>commentable</code> column, in addition to the foreign key <code>commentable_id</code>.</p><p>The polymorphic association can be implemented with an <em>association scope</em> :</p><pre><code class="lang-js"><code class="source-code prettyprint">this.Post.hasMany(this.Comment, {
  foreignKey: &apos;commentable_id&apos;,
  scope: {
    commentable: &apos;post&apos;
  }
});</code>
</code></pre><p>When calling <code>post.getComments()</code>, this will automatically add <code>WHERE commentable = &apos;post&apos;</code>. Similarly, when adding new comments to a post, <code>commentable</code> will automagically be set to <code>&apos;post&apos;</code>. The association scope is meant to live in the background without the programmer having to worry about it - it cannot be disabled. For a more complete polymorphic example, see <a href="./manual/associations/#scopes">Association scopes</a></p><p>Consider then, that Post has a default scope which only shows active posts: <code>where: { active: true }</code>. This scope lives on the associated model (Post), and not on the association like the <code>commentable</code> scope did. Just like the default scope is applied when calling <code>Post.findAll()</code>, it is also applied when calling <code>User.getPosts()</code> - this will only return the active posts for that user.</p><p>To disable the default scope, pass <code>scope: null</code> to the getter: <code>User.getPosts({ scope: null })</code>. Similarly, if you want to apply other scopes, pass an array like you would to <code>.scope</code>:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.getPosts({ scope: [&apos;scope1&apos;, &apos;scope2&apos;]});</code>
</code></pre><p>If you want to create a shortcut method to a scope on an associated model, you can pass the scoped model to the association. Consider a shortcut to get all deleted posts for a user:</p><pre><code class="lang-js"><code class="source-code prettyprint">var Post = sequelize.define(&apos;post&apos;, attributes, {
  defaultScope: {
    where: {
      active: true
    }
  },
  scopes: {
    deleted: {
      where: {
        deleted: true
      }
    }
  }
});

User.hasMany(Post); // regular getPosts association
User.hasMany(Post.scope(&apos;deleted&apos;), { as: &apos;deletedPosts&apos; });</code>
</code></pre><pre><code class="lang-js"><code class="source-code prettyprint">User.getPosts(); // WHERE active = true
User.getDeletedPosts(); // WHERE deleted = true</code>
</code></pre></div>
        <a data-ice="link" href="manual/tutorial/scopes.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">Hooks</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Hooks</h1><p>Hooks (also known as callbacks or lifecycle events), are functions which are called before and after calls in sequelize are executed. For example, if you want to always set a value on a model before saving it, you can add a <code>beforeUpdate</code> hook.</p><p>For a full list of hooks, see <a href="/api/hooks">Hooks API</a>.</p><h2>Order of Operations</h2><pre><code><code class="source-code prettyprint">(1)
  beforeBulkCreate(instances, options, fn)
  beforeBulkDestroy(options, fn)
  beforeBulkUpdate(options, fn)
(2)
  beforeValidate(instance, options, fn)
(-)
  validate
(3)
  afterValidate(instance, options, fn)
  - or -
  validationFailed(instance, options, error, fn)
(4)
  beforeCreate(instance, options, fn)
  beforeDestroy(instance, options, fn)
  beforeUpdate(instance, options, fn)
  beforeSave(instance, options, fn)
  beforeUpsert(values, options, fn)
(-)
  create
  destroy
  update
(5)
  afterCreate(instance, options, fn)
  afterDestroy(instance, options, fn)
  afterUpdate(instance, options, fn)
  afterSave(instance, options, fn)
  afterUpsert(created, options, fn)
(6)
  afterBulkCreate(instances, options, fn)
  afterBulkDestroy(options, fn)
  afterBulkUpdate(options, fn)</code>
</code></pre><h2>Declaring Hooks</h2><p>Arguments to hooks are passed by reference. This means, that you can change the values, and this will be reflected in the insert / update statement. A hook may contain async actions - in this case the hook function should return a promise.</p><p>There are currently three ways to programmatically add hooks:</p><pre><code class="lang-js"><code class="source-code prettyprint">// Method 1 via the .define() method
var User = sequelize.define(&apos;user&apos;, {
  username: DataTypes.STRING,
  mood: {
    type: DataTypes.ENUM,
    values: [&apos;happy&apos;, &apos;sad&apos;, &apos;neutral&apos;]
  }
}, {
  hooks: {
    beforeValidate: function(user, options) {
      user.mood = &apos;happy&apos;
    },
    afterValidate: function(user, options) {
      user.username = &apos;Toni&apos;
    }
  }
})

// Method 2 via the .hook() method
User.hook(&apos;beforeValidate&apos;, function(user, options) {
  user.mood = &apos;happy&apos;
})

User.hook(&apos;afterValidate&apos;, function(user, options) {
  return sequelize.Promise.reject(&quot;I&apos;m afraid I can&apos;t let you do that!&quot;)
})

// Method 3 via the direct method
User.beforeCreate(function(user, options) {
  return hashPassword(user.password).then(function (hashedPw) {
    user.password = hashedPw;
  });
})

User.afterValidate(&apos;myHookAfter&apos;, function(user, options, fn) {
  user.username = &apos;Toni&apos;
})</code>
</code></pre><h2>Removing hooks</h2><p>Only a hook with name param can be removed.</p><pre><code class="lang-js"><code class="source-code prettyprint">var Book = sequelize.define(&apos;book&apos;, {
  title: DataTypes.STRING
})

Book.addHook(&apos;afterCreate&apos;, &apos;notifyUsers&apos;, function(book, options) {
  // ...
})

Book.removeHook(&apos;afterCreate&apos;, &apos;notifyUsers&apos;)</code>
</code></pre><h2>Global / universal hooks</h2><p>Global hooks are hooks which are run for all models. They can define behaviours that you want for all your models, and are especially useful for plugins. They can be defined in two ways, which have slightly different semantics:</p><h3>Sequelize.options.define (default hook)</h3><pre><code class="lang-js"><code class="source-code prettyprint">var sequelize = new Sequelize(..., {
    define: {
        hooks: {
            beforeCreate: function () {
                // Do stuff
            }
        }
    }
});</code>
</code></pre><p>This adds a default hook to all models, which is run if the model does not define its own <code>beforeCreate</code> hook:</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = sequelize.define(&apos;user&apos;);
var Project = sequelize.define(&apos;project&apos;, {}, {
    hooks: {
        beforeCreate: function () {
            // Do other stuff
        }
    }
});

User.create() // Runs the global hook
Project.create() // Runs its own hook (because the global hook is overwritten)</code>
</code></pre><h3>Sequelize.addHook (permanent hook)</h3><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.addHook(&apos;beforeCreate&apos;, function () {
    // Do stuff
});</code>
</code></pre><p>This hooks is always run before create, regardless of whether the model specifies its own <code>beforeCreate</code> hook:</p><pre><code class="lang-js"><code class="source-code prettyprint">var User = sequelize.define(&apos;user&apos;);
var Project = sequelize.define(&apos;project&apos;, {}, {
    hooks: {
        beforeCreate: function () {
            // Do other stuff
        }
    }
});

User.create() // Runs the global hook
Project.create() // Runs its own hook, followed by the global hook</code>
</code></pre><p>Local hooks are always run before global hooks.</p><h3>Instance hooks</h3><p>The following hooks will emit whenever you&apos;re editing a single object</p><pre><code><code class="source-code prettyprint">beforeValidate
afterValidate or validationFailed
beforeCreate / beforeUpdate  / beforeDestroy
afterCreate / afterUpdate / afterDestroy</code>
</code></pre><pre><code class="lang-js"><code class="source-code prettyprint">// ...define ...
User.beforeCreate(function(user) {
  if (user.accessLevel &gt; 10 &amp;&amp; user.username !== &quot;Boss&quot;) {
    throw new Error(&quot;You can&apos;t grant this user an access level above 10!&quot;)
  }
})</code>
</code></pre><p>This example will return an error:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.create({username: &apos;Not a Boss&apos;, accessLevel: 20}).catch(function(err) {
  console.log(err) // You can&apos;t grant this user an access level above 10!
})</code>
</code></pre><p>The following example would return successful:</p><pre><code class="lang-js"><code class="source-code prettyprint">User.create({username: &apos;Boss&apos;, accessLevel: 20}).then(function(user) {
  console.log(user) // user object with username as Boss and accessLevel of 20
})</code>
</code></pre><h3>Model hooks</h3><p>Sometimes you&apos;ll be editing more than one record at a time by utilizing the <code>bulkCreate, update, destroy</code> methods on the model. The following will emit whenever you&apos;re using one of those methods.</p><pre><code><code class="source-code prettyprint">beforeBulkCreate / beforeBulkUpdate / beforeBulkDestroy
afterBulkCreate / afterBulkUpdate / afterBulkDestroy</code>
</code></pre><p>If you want to emit hooks for each individual record, along with the bulk hooks you can pass <code>individualHooks: true</code> to the call.</p><pre><code class="lang-js"><code class="source-code prettyprint">Model.destroy({ where: {accessLevel: 0}, individualHooks: true})
// Will select all records that are about to be deleted and emit before- + after- Destroy on each instance

Model.update({username: &apos;Toni&apos;}, { where: {accessLevel: 0}, individualHooks: true})
// Will select all records that are about to be updated and emit before- + after- Update on each instance</code>
</code></pre><p>Some model hooks have two or three parameters sent to each hook depending on it&apos;s type.</p><pre><code class="lang-js"><code class="source-code prettyprint">Model.beforeBulkCreate(function(records, fields) {
  // records = the first argument sent to .bulkCreate
  // fields = the second argument sent to .bulkCreate
})

Model.bulkCreate([
  {username: &apos;Toni&apos;}, // part of records argument
  {username: &apos;Tobi&apos;} // part of records argument
], [&apos;username&apos;] /* part of fields argument */)

Model.beforeBulkUpdate(function(attributes, where) {
  // attributes = first argument sent to Model.update
  // where = second argument sent to Model.update
})

Model.update({gender: &apos;Male&apos;} /*attributes argument*/, { where: {username: &apos;Tom&apos;}} /*where argument*/)

Model.beforeBulkDestroy(function(whereClause) {
  // whereClause = first argument sent to Model.destroy
})

Model.destroy({ where: {username: &apos;Tom&apos;}} /*whereClause argument*/)</code>
</code></pre><p>If you use <code>Model.bulkCreate(...)</code> with the <code>updatesOnDuplicate</code> option, changes made in the hook to fields that aren&apos;t given in the <code>updatesOnDuplicate</code> array will not be persisted to the database. However it is possible to change the updatesOnDuplicate option inside the hook if this is what you want.</p><pre><code><code class="source-code prettyprint">// Bulk updating existing users with updatesOnDuplicate option
Users.bulkCreate([{ id: 1, isMemeber: true},
                 { id: 2, isMember: false}],
                 { updatesOnDuplicate: [&apos;isMember&apos;]})

User.beforeBulkCreate(function (users, options) {
  users.forEach(function (user) {
    if (user.isMember) {
      user.memberSince = new Date()
    }
  })

  // Add memberSince to updatesOnDuplicate otherwise the memberSince date wont be
  // saved to the database
  options.updatesOnDuplicate.push(&apos;memberSince&apos;)
})</code>
</code></pre><h2>Associations</h2><p>For the most part hooks will work the same for instances when being associated except a few things</p><ol>
<li>When using add/set functions the beforeUpdate/afterUpdate hooks will run.</li>
<li>The only way to call beforeDestroy/afterDestroy hooks are on associations with <code>onDelete: &apos;cascade&apos;</code> and the option <code>hooks: true</code>. For instance:</li>
</ol><pre><code class="lang-js"><code class="source-code prettyprint">var Projects = sequelize.define(&apos;projects&apos;, {
  title: DataTypes.STRING
})

var Tasks = sequelize.define(&apos;tasks&apos;, {
  title: DataTypes.STRING
})

Projects.hasMany(Tasks, { onDelete: &apos;cascade&apos;, hooks: true })
Tasks.belongsTo(Projects)</code>
</code></pre><p>This code will run beforeDestroy/afterDestroy on the Tasks table. Sequelize, by default, will try to optimize your queries as much as possible. When calling cascade on delete, Sequelize will simply execute a</p><pre><code class="lang-sql"><code class="source-code prettyprint">DELETE FROM `table` WHERE associatedIdentifier = associatedIdentifier.primaryKey</code>
</code></pre><p>However, adding <code>hooks: true</code> explicitly tells Sequelize that optimization is not of your concern and will perform a <code>SELECT</code> on the associated objects and destroy each instance one by one in order to be able to call the hooks with the right parameters.</p><p>If your association is of type <code>n:m</code>, you may be interested in firing hooks on the through model when using the <code>remove</code> call. Internally, sequelize is using <code>Model.destroy</code> resulting in calling the <code>bulkDestroy</code> instead of the <code>before/afterDestroy</code> hooks on each through instance.</p><p>This can be simply solved by passing <code>{individualHooks: true}</code> to the <code>remove</code> call, resulting on each hook to be called on each removed through instance object.</p><h2>A Note About Transactions</h2><p>Note that many model operations in Sequelize allow you to specify a transaction in the options parameter of the method. If a transaction <em>is</em> specified in the original call, it will be present in the options parameter passed to the hook function. For example, consider the following snippet:</p><pre><code class="lang-js"><code class="source-code prettyprint">// Here we use the promise-style of async hooks rather than
// the callback.
User.hook(&apos;afterCreate&apos;, function(user, options) {
  // &apos;transaction&apos; will be available in options.transaction

  // This operation will be part of the same transaction as the
  // original User.create call.
  return User.update({
    mood: &apos;sad&apos;
  }, {
    where: {
      id: user.id
    },
    transaction: options.transaction
  });
});


sequelize.transaction(function(t) {
  User.create({
    username: &apos;someguy&apos;,
    mood: &apos;happy&apos;,
    transaction: t
  });
});</code>
</code></pre><p>If we had not included the transaction option in our call to <code>User.update</code> in the preceding code, no change would have occurred, since our newly created user does not exist in the database until the pending transaction has been committed.</p><h3>Internal Transactions</h3><p>It is very important to recognize that sequelize may make use of transactions internally for certain operations such as <code>Model.findOrCreate</code>. If your hook functions execute read or write operations that rely on the object&apos;s presence in the database, or modify the object&apos;s stored values like the example in the preceding section, you should always specify <code>{ transaction: options.transaction }</code>.</p><p>If the hook has been called in the process of a transacted operation, this makes sure that your dependent read/write is a part of that same transaction. If the hook is not transacted, you have simply specified <code>{ transaction: null }</code> and can expect the default behaviour.</p></div>
        <a data-ice="link" href="manual/tutorial/hooks.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;"><span data-ice="label-inner">Raw queries</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Raw queries</h1><p>As there are often use cases in which it is just easier to execute raw / already prepared SQL queries, you can utilize the function <code>sequelize.query</code>.</p><p>By default the function will return two arguments - a results array, and an object containing metadata (affected rows etc.). Note that since this is a raw query, the metadata (property names etc.) is dialect specific. Some dialects return the metadata &quot;within&quot; the results object (as properties on an array). However, two arguments will always be returned, but for MSSQL and MySQL it will be two references to the same object.</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.query(&quot;UPDATE users SET y = 42 WHERE x = 12&quot;).spread(function(results, metadata) {
  // Results will be an empty array and metadata will contain the number of affected rows.
})</code>
</code></pre><p>In cases where you don&apos;t need to access the metadata you can pass in a query type to tell sequelize how to format the results. For example, for a simple select query you could do:</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.query(&quot;SELECT * FROM `users`&quot;, { type: sequelize.QueryTypes.SELECT})
  .then(function(users) {
    // We don&apos;t need spread here, since only the results will be returned for select queries
  })</code>
</code></pre><p>Several other query types are available. <a href="https://github.com/sequelize/sequelize/blob/master/lib/query-types.js">Peek into the source for details</a></p><p>A second option is the model. If you pass a model the returned data will be instances of that model.</p><pre><code class="lang-js"><code class="source-code prettyprint">// Callee is the model definition. This allows you to easily map a query to a predefined model
sequelize.query(&apos;SELECT * FROM projects&apos;, { model: Projects }).then(function(projects){
  // Each record will now be a instance of Project
})</code>
</code></pre><h2>Replacements</h2><p>Replacements in a query can be done in two different ways, either using named parameters (starting with <code>:</code>), or unnamed, represented by a <code>?</code>. Replacements are passed in the options object.</p><ul>
<li>If an array is passed, <code>?</code> will be replaced in the order that they appear in the array</li>
<li>If an object is passed, <code>:key</code> will be replaced with the keys from that object. If the object contains keys not found in the query or vice versa, an exception will be thrown.</li>
</ul><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.query(&apos;SELECT * FROM projects WHERE status = ?&apos;,
  { replacements: [&apos;active&apos;], type: sequelize.QueryTypes.SELECT }
).then(function(projects) {
  console.log(projects)
})

sequelize.query(&apos;SELECT * FROM projects WHERE status = :status &apos;,
  { replacements: { status: &apos;active&apos; }, type: sequelize.QueryTypes.SELECT }
).then(function(projects) {
  console.log(projects)
})</code>
</code></pre><p>Array replacements will automatically be handled, the following query searches for projects where the status matches an array of values.</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.query(&apos;SELECT * FROM projects WHERE status IN(:status) &apos;,
  { replacements: { status: [&apos;active&apos;, &apos;inactive&apos;] }, type: sequelize.QueryTypes.SELECT }
).then(function(projects) {
  console.log(projects)
})</code>
</code></pre><p>To use the wildcard operator %, append it to your replacement. The following query matches users with names that start with &apos;ben&apos;.</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.query(&apos;SELECT * FROM users WHERE name LIKE :search_name &apos;,
  { replacements: { search_name: &apos;ben%&apos;  }, type: sequelize.QueryTypes.SELECT }
).then(function(projects) {
  console.log(projects)
})</code>
</code></pre><h2>Bind Parameter</h2><p>Bind parameters are like replacements. Except replacements are escaped and inserted into the query by sequelize before the query is sent to the database, while bind parameters are sent to the database outside the SQL query text. A query can have either bind parameters or replacements.</p><p>Only SQLite and PostgreSQL support bind parameters. Other dialects will insert them into the SQL query in the same way it is done for replacements. Bind parameters are referred to by either $1, $2, ... (numeric) or $key (alpha-numeric). This is independent of the dialect.</p><ul>
<li>If an array is passed, <code>$1</code> is bound to the 1st element in the array (<code>bind[0]</code>)</li>
<li>If an object is passed, <code>$key</code> is bound to <code>object[&apos;key&apos;]</code>. Each key must begin with a non-numeric char. <code>$1</code> is not a valid key, even if <code>object[&apos;1&apos;]</code> exists.</li>
<li>In either case <code>$$</code> can be used to escape a literal <code>$</code> sign.</li>
</ul><p>The array or object must contain all bound values or Sequelize will throw an exception. This applies even to cases in which the database may ignore the bound parameter.</p><p>The database may add further restrictions to this. Bind parameters cannot be SQL keywords, nor table or column names. They are also ignored in quoted text or data. In PostgreSQL it may also be needed to typecast them, if the type cannot be inferred from the context <code>$1::varchar</code>.</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.query(&apos;SELECT *, &quot;text with literal $$1 and literal $$status&quot; as t FROM projects WHERE status = $1&apos;,
  { bind: [&apos;active&apos;], type: sequelize.QueryTypes.SELECT }
).then(function(projects) {
  console.log(projects)
})

sequelize.query(&apos;SELECT *, &quot;text with literal $$1 and literal $$status&quot; as t FROM projects WHERE status = $status&apos;,
  { bind: { status: &apos;active&apos; }, type: sequelize.QueryTypes.SELECT }
).then(function(projects) {
  console.log(projects)
})</code>
</code></pre></div>
        <a data-ice="link" href="manual/tutorial/raw-queries.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-tutorial" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">Migrations</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Migrations</h1><p>Sequelize <code>2.0.0</code> introduces a new CLI which is based on <a href="http://gulpjs.com/">gulp</a> and combines <a href="https://github.com/sequelize/cli">sequelize-cli</a> and <a href="https://github.com/sequelize/gulp-sequelize">gulp-sequelize</a>. The CLI ships support for migrations and project bootstrapping. With migrations you can transfer your existing database into another state and vice versa: Those state transitions are saved in migration files, which describe the way how to get to the new state and how to revert the changes in order to get back to the old state.</p><h2>The CLI</h2><p>In order to use the CLI you need to install the respective package:</p><pre><code class="lang-bash"><code class="source-code prettyprint">$ npm install --save sequelize-cli</code>
</code></pre><p>As with any npm package, you can use the global flag (<code>-g</code>) to install the CLI globally. If you have installed the CLI without the global flag, use <code>node_modules/.bin/sequelize [command]</code> instead of <code>sequelize [command]</code>.</p><p>The CLI currently supports the following commands:</p><pre><code class="lang-bash"><code class="source-code prettyprint">$ sequelize db:migrate        # Run pending migrations.
$ sequelize db:migrate:undo   # Revert the last migration run.
$ sequelize help              # Display this help text.
$ sequelize init              # Initializes the project.
$ sequelize migration:create  # Generates a new migration file.
$ sequelize version           # Prints the version number.</code>
</code></pre><p>Further and more detailed information about the available commands
can be obtained via the help command:</p><pre><code class="lang-bash"><code class="source-code prettyprint">$ sequelize help:init
$ sequelize help:db:migrate
$ sequelize help:db:migrate:undo
# etc</code>
</code></pre><p>The latter one for example will print out the following output:</p><pre><code class="lang-bash"><code class="source-code prettyprint">Sequelize [CLI: v0.0.2, ORM: v1.7.5]

COMMANDS
    sequelize db:migrate:undo -- Revert the last migration run.

DESCRIPTION
    Revert the last migration run.

OPTIONS
    --env           The environment to run the command in. Default: development
    --options-path  The path to a JSON file with additional options. Default: none
    --coffee        Enables coffee script support. Default: false
    --config        The path to the config file. Default: config/config.json</code>
</code></pre><h2>Skeleton</h2><p>The following skeleton shows a typical migration file. All migrations are expected to be located in a folder called <code>migrations</code> at the very top of the project. The sequelize binary can generate a migration skeleton. See the above section for more details.</p><pre><code class="lang-js"><code class="source-code prettyprint">module.exports = {
  up: function(queryInterface, Sequelize) {
    // logic for transforming into the new state
  },

  down: function(queryInterface, Sequelize) {
    // logic for reverting the changes
  }
}</code>
</code></pre><p>The passed <code>queryInterface</code> object can be used to modify the database. The <code>Sequelize</code> object stores the available data types such as <code>STRING</code> or <code>INTEGER</code>. Function <code>up</code> or <code>down</code> should return a <code>Promise</code>. Here is some code:</p><pre><code class="lang-js"><code class="source-code prettyprint">module.exports = {
  up: function(queryInterface, Sequelize) {
    return queryInterface.dropAllTables();
  }
}</code>
</code></pre><p>The available methods of the queryInterface object are the following.</p><h2>Functions</h2><p>Using the <code>queryInterface</code> object described before, you will have access to most of already introduced functions. Furthermore there are some other methods, which are designed to actually change the database schema.</p><h3>createTable(tableName, attributes, options)</h3><p>This method allows creation of new tables. It is allowed to pass simple or complex attribute definitions. You can define the encoding of the table and the table&apos;s engine via options</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.createTable(
  &apos;nameOfTheNewTable&apos;,
  {
    id: {
      type: Sequelize.INTEGER,
      primaryKey: true,
      autoIncrement: true
    },
    createdAt: {
      type: Sequelize.DATE
    },
    updatedAt: {
      type: Sequelize.DATE
    },
    attr1: Sequelize.STRING,
    attr2: Sequelize.INTEGER,
    attr3: {
      type: Sequelize.BOOLEAN,
      defaultValue: false,
      allowNull: false
    },
    //foreign key usage
    attr4: {
        type: Sequelize.INTEGER,
        references: {
            model: &apos;another_table_name&apos;,
            key: &apos;id&apos;
        },
        onUpdate: &apos;cascade&apos;,
        onDelete: &apos;cascade&apos;
    }
  },
  {
    engine: &apos;MYISAM&apos;,                     // default: &apos;InnoDB&apos;
    charset: &apos;latin1&apos;,                    // default: null
    schema: &apos;public&apos;                      // default: public, PostgreSQL only.
  }
)</code>
</code></pre><h3>dropTable(tableName, options)</h3><p>This method allows deletion of an existing table.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.dropTable(&apos;nameOfTheExistingTable&apos;)</code>
</code></pre><h3>dropAllTables(options)</h3><p>This method allows deletion of all existing tables in the database.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.dropAllTables()</code>
</code></pre><h3>renameTable(before, after, options)</h3><p>This method allows renaming of an existing table.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.renameTable(&apos;Person&apos;, &apos;User&apos;)</code>
</code></pre><h3>showAllTables(options)</h3><p>This method returns the name of all existing tables in the database.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.showAllTables().then(function(tableNames) {})</code>
</code></pre><h3>describeTable(tableName, options)</h3><p>This method returns an array of hashes containing information about all attributes in the table.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.describeTable(&apos;Person&apos;).then(function(attributes) {
  /*
    attributes will be something like:

    {
      name: {
        type:         &apos;VARCHAR(255)&apos;, // this will be &apos;CHARACTER VARYING&apos; for pg!
        allowNull:    true,
        defaultValue: null
      },
      isBetaMember: {
        type:         &apos;TINYINT(1)&apos;, // this will be &apos;BOOLEAN&apos; for pg!
        allowNull:    false,
        defaultValue: false
      }
    }
  */
})</code>
</code></pre><h3>addColumn(tableNameOrOptions, attributeName, dataTypeOrOptions, options)</h3><p>This method allows adding columns to an existing table. The data type can be simple or complex.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.addColumn(
  &apos;nameOfAnExistingTable&apos;,
  &apos;nameOfTheNewAttribute&apos;,
  Sequelize.STRING
)

// or

queryInterface.addColumn(
  &apos;nameOfAnExistingTable&apos;,
  &apos;nameOfTheNewAttribute&apos;,
  {
    type: Sequelize.STRING,
    allowNull: false
  }
)

// or with an explicit schema:

queryInterface.addColumn({
    tableName: &apos;Person&apos;,
    schema: &apos;public&apos;
  },
  &apos;signature&apos;,
  Sequelize.STRING
)</code>
</code></pre><h3>removeColumn(tableNameOrOptions, attributeName, options)</h3><p>This method allows deletion of a specific column of an existing table.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.removeColumn(&apos;Person&apos;, &apos;signature&apos;)

// or with an explicit schema:

queryInterface.removeColumn({
  tableName: &apos;Person&apos;,
  schema: &apos;public&apos;
}, &apos;signature&apos;);</code>
</code></pre><h3>changeColumn(tableName, attributeName, dataTypeOrOptions, options)</h3><p>This method changes the meta data of an attribute. It is possible to change the default value, allowance of null or the data type. Please make sure, that you are completely describing the new data type.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.changeColumn(
  &apos;nameOfAnExistingTable&apos;,
  &apos;nameOfAnExistingAttribute&apos;,
  {
    type: Sequelize.FLOAT,
    allowNull: false,
    defaultValue: 0.0
  }
)</code>
</code></pre><h3>renameColumn(tableName, attrNameBefore, attrNameAfter, options)</h3><p>This methods allows renaming attributes.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.renameColumn(&apos;Person&apos;, &apos;signature&apos;, &apos;sig&apos;)</code>
</code></pre><h3>addIndex(tableName, attributes, options)</h3><p>This methods creates indexes for specific attributes of a table. The index name will be automatically generated if it is not passed via in the options (see below).</p><pre><code class="lang-js"><code class="source-code prettyprint">// This example will create the index person_firstname_lastname
queryInterface.addIndex(&apos;Person&apos;, [&apos;firstname&apos;, &apos;lastname&apos;])

// This example will create a unique index with the name SuperDuperIndex using the optional &apos;options&apos; field.
// Possible options:
// - indicesType: UNIQUE|FULLTEXT|SPATIAL
// - indexName: The name of the index. Default is __
// - parser: For FULLTEXT columns set your parser
// - indexType: Set a type for the index, e.g. BTREE. See the documentation of the used dialect
// - logging: A function that receives the sql query, e.g. console.log
// - where: A hash of attributes to limit your index(Filtered Indexes - MSSQL &amp; PostgreSQL only)
queryInterface.addIndex(
  &apos;Person&apos;,
  [&apos;firstname&apos;, &apos;lastname&apos;],
  {
    indexName: &apos;SuperDuperIndex&apos;,
    indicesType: &apos;UNIQUE&apos;
  }
)

queryInterface.addIndex(
  &apos;Person&apos;,
  [&apos;firstname&apos;, &apos;lastname&apos;],
  {
    where: {
      lastname: {
        $ne: null
      }
    }
  }
)</code>
</code></pre><h3>removeIndex(tableName, indexNameOrAttributes, options)</h3><p>This method deletes an existing index of a table.</p><pre><code class="lang-js"><code class="source-code prettyprint">queryInterface.removeIndex(&apos;Person&apos;, &apos;SuperDuperIndex&apos;)

// or

queryInterface.removeIndex(&apos;Person&apos;, [&apos;firstname&apos;, &apos;lastname&apos;])</code>
</code></pre><h2>Programmatic use</h2><p>Sequelize has a <a href="https://github.com/sequelize/umzug">sister library</a> for programmatically handling execution and logging of migration tasks.</p></div>
        <a data-ice="link" href="manual/tutorial/migrations.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-advanced" data-section-count="&#x25A0;&#x25A0;"><span data-ice="label-inner">Working with legacy tables</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Working with legacy tables</h1><p>While out of the box Sequelize will seem a bit opinionated it&apos;s trivial to both legacy and forward proof your application by defining (otherwise generated) table and field names.</p><h2>Tables</h2><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.define(&apos;user&apos;, {

}, {
  tableName: &apos;users&apos;
});</code>
</code></pre><h2>Fields</h2><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.define(&apos;modelName&apos;, {
  userId: {
    type: Sequelize.INTEGER,
    field: &apos;user_id&apos;
  }
});</code>
</code></pre><h2>Primary keys</h2><p>Sequelize will assume your table has a <code>id</code> primary key property by default.</p><p>To define your own primary key:</p><pre><code class="lang-js"><code class="source-code prettyprint">sequelize.define(&apos;collection&apos;, {
  uid: {
    type: Sequelize.INTEGER,
    primaryKey: true,
    autoIncrement: true // Automatically gets converted to SERIAL for postgres
  }
});

sequelize.define(&apos;collection&apos;, {
  uuid: {
    type: Sequelize.UUID,
    primaryKey: true
  }
});</code>
</code></pre><p>And if your model has no primary key at all you can use <code>Model.removeAttribute(&apos;id&apos;);</code></p><h2>Foreign keys</h2><pre><code class="lang-js"><code class="source-code prettyprint">// 1:1
Organization.belongsTo(User, {foreignKey: &apos;owner_id&apos;});
User.hasOne(Organization, {foreignKey: &apos;owner_id&apos;});

// 1:M
Project.hasMany(Task, {foreignkey: &apos;tasks_pk&apos;});
Task.belongsTo(Project, {foreignKey: &apos;tasks_pk&apos;});

// N:M
User.hasMany(Role, {through: &apos;user_has_roles&apos;, foreignKey: &apos;user_role_user_id&apos;});
Role.hasMany(User, {through: &apos;user_has_roles&apos;, foreignKey: &apos;roles_identifier&apos;});</code>
</code></pre></div>
        <a data-ice="link" href="manual/advanced/legacy.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-reference" data-section-count="&#x25A0;&#x25A0;&#x25A0;&#x25A0;&#x25A0;"><span data-ice="label-inner">References</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>References</h1>
<div data-ice="classSummary"><h2 id="class">Class Summary</h2><table class="summary" data-ice="summary">
  <thead><tr><td data-ice="title" colspan="3">Static Public Class Summary</td></tr></thead>
  <tbody>
  
  <tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~AccessDeniedError.html">AccessDeniedError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a connection to a database is refused due to insufficient privileges</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/associations/base.js~Association.html">Association</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Creating associations in sequelize is done by calling one of the belongsTo / hasOne / hasMany / belongsToMany functions on a model (the source), and providing another model as the first argument to the function (the target).</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~AssociationError.html">AssociationError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when an association is improperly constructed (see message for details)</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~BaseError.html">BaseError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Sequelize provides a host of custom error classes, to allow you to do easier debugging.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/associations/belongs-to.js~BelongsTo.html">BelongsTo</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>One-to-one association</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/associations/belongs-to-many.js~BelongsToMany.html">BelongsToMany</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Many-to-many association with a join table.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~ConnectionError.html">ConnectionError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A base class for all connection related errors.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~ConnectionRefusedError.html">ConnectionRefusedError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a connection to a database is refused</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~ConnectionTimedOutError.html">ConnectionTimedOutError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a connection to a database times out</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~DatabaseError.html">DatabaseError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A base class for all database related errors.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~EagerLoadingError.html">EagerLoadingError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when an include statement is improperly constructed (see message for details)</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~EmptyResultError.html">EmptyResultError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a record was not found, Usually used with rejectOnEmpty mode (see message for details)</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~ExclusionConstraintError.html">ExclusionConstraintError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when an exclusion constraint is violated in the database</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~ForeignKeyConstraintError.html">ForeignKeyConstraintError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a foreign key constraint is violated in the database</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/associations/has-many.js~HasMany.html">HasMany</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>One-to-many association</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/associations/has-one.js~HasOne.html">HasOne</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>One-to-one association</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~HostNotFoundError.html">HostNotFoundError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a connection to a database has a hostname that was not found</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~HostNotReachableError.html">HostNotReachableError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a connection to a database has a hostname that was not reachable</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~InstanceError.html">InstanceError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a some problem occurred with Instance methods (see message for details)</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~InvalidConnectionError.html">InvalidConnectionError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a connection to a database has invalid values for any of the connection parameters</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/model.js~Model.html">Model</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A Model represents a table in the database.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~OptimisticLockError.html">OptimisticLockError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when attempting to update a stale model instance</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~QueryError.html">QueryError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a query is passed invalid options (see message for details)</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/sequelize.js~Sequelize.html">Sequelize</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>This is the main class, the entry point to sequelize.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~SequelizeScopeError.html">SequelizeScopeError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Scope Error.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~TimeoutError.html">TimeoutError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a database query times out because of a deadlock</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/transaction.js~Transaction.html">Transaction</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>The transaction object is used to identify a running transaction.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~UniqueConstraintError.html">UniqueConstraintError</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Thrown when a unique constraint is violated in the database</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~ValidationError.html">ValidationError</a></span></span><span data-ice="signature">(message: <span>string</span>, errors: <span>Array</span>)</span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Validation Error.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="class/lib/errors/index.js~ValidationErrorItem.html">ValidationErrorItem</a></span></span><span data-ice="signature">(message: <span>string</span>, type: <span>string</span>, path: <span>string</span>, value: <span>string</span>)</span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Validation Error Item
Instances of this class are included in the <code>ValidationError.errors</code> property.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
</tbody>
</table>
</div>


<div data-ice="variableSummary"><h2 id="variable">Variable Summary</h2><table class="summary" data-ice="summary">
  <thead><tr><td data-ice="title" colspan="3">Static Public Variable Summary</td></tr></thead>
  <tbody>
  
  <tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="variable/index.html#static-variable-DataTypes">DataTypes</a></span></span><span data-ice="signature">: <span>*</span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A convenience class holding commonly used data types.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="variable/index.html#static-variable-Deferrable">Deferrable</a></span></span><span data-ice="signature">: <span>*</span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A collection of properties related to deferrable constraints.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          <span data-ice="name"><span><a href="variable/index.html#static-variable-QueryTypes">QueryTypes</a></span></span><span data-ice="signature">: <span>*</span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>An enum of query types used by <code>sequelize.query</code></p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
</tbody>
</table>
</div>


</div>
        <a data-ice="link" href="identifiers.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-faq" data-section-count="&#x25A0;"><span data-ice="label-inner">Who&apos;s using sequelize?</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Who&apos;s using sequelize?</h1><p><a href="http://www.walmartlabs.com/"><img src="./manual/asset/walmart-labs-logo.png" alt="Walmart labs logo"></a></p><blockquote>
<p>... we are avid users of sequelize (and have been for the past 18 months) (Feb 2017)</p>
</blockquote><p><a href="https://snaplytics.io"><img src="./manual/asset/logo-snaplytics-green.png" alt="Snaplytics logo"></a></p><blockquote>
<p>We&apos;ve been using sequelize since we started in the beginning of 2015. We use it for our graphql servers (in connection with <a href="./manual/github.com/mickhansen/graphql-sequelize">graphql-sequelize</a>), and for all our background workers.</p>
</blockquote><p><a href="https://connectedcars.dk/"><img src="./manual/asset/connected-cars.png" alt="Connected Cars logo"></a></p></div>
        <a data-ice="link" href="manual/faq/whos-using.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <h1 data-ice="label" class="manual-color manual-color-faq" data-section-count="&#x25A0;"><span data-ice="label-inner">Imprint</span></h1>
      <div class="manual-card">
        <div data-ice="card"><h1>Imprint</h1><ul>
<li>Boring legal stuff for the rest of us.
As there are people who are suing for fun and glory, you can find the respective information about the author of the page right here. Have fun reading ...</li>
</ul><h2>AUTHOR(S)</h2><pre><code><code class="source-code prettyprint">Main author:

Sascha Depold
Uhlandstr. 122
10717 Berlin
sascha [at] depold [dot] com
[plus] 49 152 [slash] 03878582</code>
</code></pre><h2>INHALTLICHE VERANTWORTUNG</h2><pre><code><code class="source-code prettyprint">Ich &#xFC;bernehme keine Haftung f&#xFC;r ausgehende Links. 
Daher musst du dich bei Problemen an deren Betreiber wenden!</code>
</code></pre></div>
        <a data-ice="link" href="manual/faq/imprint.html"></a>
      </div>
    </div>
</div>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
